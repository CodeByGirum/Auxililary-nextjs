{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/components/chat/EmbeddedTable.tsx"],"sourcesContent":["\r\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { TableData } from '../../types/chat';\r\nimport { Maximize2, BarChart3, Database } from 'lucide-react';\r\n\r\ninterface EmbeddedTableProps {\r\n  data: TableData;\r\n  fileName: string;\r\n  visualHint?: string;\r\n  source?: string;\r\n  onExpand: () => void;\r\n}\r\n\r\nexport const EmbeddedTable: React.FC<EmbeddedTableProps> = ({ data, fileName, visualHint, source, onExpand }) => {\r\n  // Local state for editing and resizing\r\n  const [rows, setRows] = useState<any[]>([]);\r\n  const [headers, setHeaders] = useState<string[]>([]);\r\n  const [colWidths, setColWidths] = useState<Record<string, number>>({});\r\n  \r\n  // Interaction State\r\n  const [selectedCell, setSelectedCell] = useState<{r: number, c: string} | null>(null);\r\n  \r\n  // Resizing State\r\n  const resizingRef = useRef<{ startX: number, startWidth: number, header: string } | null>(null);\r\n\r\n  useEffect(() => {\r\n    // Sync with props (e.g. if updated from drawer)\r\n    setRows(data.rows.slice(0, 5)); // Only show first 5 rows in embedded view\r\n    setHeaders(data.headers);\r\n    \r\n    // Initialize widths\r\n    const initialWidths: Record<string, number> = {};\r\n    data.headers.forEach(h => initialWidths[h] = 120);\r\n    setColWidths(initialWidths);\r\n  }, [data]);\r\n\r\n  // --- Resizing Logic ---\r\n  const handleMouseDown = (e: React.MouseEvent, header: string) => {\r\n    e.preventDefault();\r\n    resizingRef.current = {\r\n      startX: e.clientX,\r\n      startWidth: colWidths[header] || 120,\r\n      header\r\n    };\r\n    document.addEventListener('mousemove', handleMouseMove);\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n  };\r\n\r\n  const handleMouseMove = useCallback((e: MouseEvent) => {\r\n    if (!resizingRef.current) return;\r\n    const { startX, startWidth, header } = resizingRef.current;\r\n    const diff = e.clientX - startX;\r\n    setColWidths(prev => ({\r\n      ...prev,\r\n      [header]: Math.max(50, startWidth + diff)\r\n    }));\r\n  }, []);\r\n\r\n  const handleMouseUp = useCallback(() => {\r\n    resizingRef.current = null;\r\n    document.removeEventListener('mousemove', handleMouseMove);\r\n    document.removeEventListener('mouseup', handleMouseUp);\r\n  }, [handleMouseMove]);\r\n\r\n  // --- Interaction Logic ---\r\n  const handleCellClick = (r: number, c: string) => {\r\n    setSelectedCell({ r, c });\r\n  };\r\n\r\n  // Helper to get column letter (A, B, C...)\r\n  const getColLetter = (index: number) => String.fromCharCode(65 + index);\r\n\r\n  return (\r\n    <div className=\"w-full border border-gray-300 dark:border-[#444] bg-white dark:bg-[#1e1e1e] shadow-sm select-none flex flex-col rounded-xl overflow-hidden font-sans transition-all hover:shadow-md group\">\r\n      {/* Top Bar */}\r\n      <div className=\"flex items-center justify-between px-3 py-2 bg-[#f8f9fa] dark:bg-[#252525] border-b border-gray-300 dark:border-[#444]\">\r\n        <div className=\"flex items-center gap-3 min-w-0\">\r\n          <div className={`flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center ${visualHint ? 'bg-purple-600' : 'bg-[#107c41]'}`}>\r\n             {visualHint ? <BarChart3 size={16} className=\"text-white\" /> : <Database size={16} className=\"text-white\" />}\r\n          </div>\r\n          <div className=\"flex flex-col min-w-0\">\r\n             <div className=\"flex items-center gap-2\">\r\n                <span className=\"text-xs font-semibold text-gray-900 dark:text-gray-100 truncate\">{fileName}</span>\r\n                {source && (\r\n                    <span className=\"px-1.5 py-0.5 rounded-md bg-gray-200 dark:bg-[#333] text-[9px] font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wide border border-gray-300 dark:border-[#444]\">\r\n                        {source}\r\n                    </span>\r\n                )}\r\n             </div>\r\n             {visualHint && <span className=\"text-[9px] text-purple-600 dark:text-purple-400 uppercase font-bold tracking-wide\">Analysis Ready</span>}\r\n          </div>\r\n        </div>\r\n        <button \r\n            onClick={onExpand}\r\n            className=\"flex-shrink-0 flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium bg-white dark:bg-[#333] text-gray-700 dark:text-gray-200 border border-gray-200 dark:border-[#444] hover:bg-gray-50 dark:hover:bg-[#404040] rounded-full transition-colors shadow-sm\"\r\n        >\r\n            <Maximize2 size={12} strokeWidth={2} />\r\n            <span className=\"hidden sm:inline\">Expand</span>\r\n        </button>\r\n      </div>\r\n\r\n      {/* Excel Grid */}\r\n      <div className=\"overflow-x-auto relative no-scrollbar bg-white dark:bg-[#1e1e1e]\">\r\n        <div className=\"inline-block min-w-full\">\r\n            {/* Headers */}\r\n            <div className=\"flex\">\r\n                {/* Row Number Header */}\r\n                <div className=\"w-10 flex-shrink-0 bg-[#f3f2f1] dark:bg-[#2b2b2b] border-r border-b border-gray-300 dark:border-[#444] h-8\"></div>\r\n                {headers.map((h, i) => (\r\n                    <div \r\n                        key={h} \r\n                        className=\"relative flex-shrink-0 flex items-center justify-center bg-[#f3f2f1] dark:bg-[#2b2b2b] border-r border-b border-gray-300 dark:border-[#444] h-8 text-[11px] font-bold text-gray-600 dark:text-gray-300\"\r\n                        style={{ width: colWidths[h] }}\r\n                    >\r\n                        {h} ({getColLetter(i)})\r\n                        {/* Resizer Handle */}\r\n                        <div \r\n                            className=\"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-[#107c41] z-10\"\r\n                            onMouseDown={(e) => handleMouseDown(e, h)}\r\n                        />\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Rows */}\r\n            {rows.map((row, rIdx) => (\r\n                <div key={rIdx} className=\"flex group\">\r\n                    {/* Row Number */}\r\n                    <div className=\"w-10 flex-shrink-0 flex items-center justify-center bg-[#f3f2f1] dark:bg-[#2b2b2b] border-r border-b border-gray-300 dark:border-[#444] text-[10px] text-gray-500 dark:text-gray-400 font-mono select-none group-hover:bg-[#e1dfdd] dark:group-hover:bg-[#333]\">\r\n                        {rIdx + 1}\r\n                    </div>\r\n                    \r\n                    {/* Cells */}\r\n                    {headers.map((h) => {\r\n                        const isSelected = selectedCell?.r === rIdx && selectedCell?.c === h;\r\n\r\n                        return (\r\n                            <div \r\n                                key={h}\r\n                                className={`\r\n                                    relative flex-shrink-0 h-7 text-xs border-r border-b border-gray-200 dark:border-[#444] px-2 flex items-center\r\n                                    ${rIdx % 2 === 0 ? 'bg-white dark:bg-[#1e1e1e]' : 'bg-[#fafafa] dark:bg-[#232323]'} \r\n                                    ${isSelected ? 'outline outline-2 outline-[#107c41] z-10' : ''}\r\n                                `}\r\n                                style={{ width: colWidths[h] }}\r\n                                onClick={() => handleCellClick(rIdx, h)}\r\n                            >\r\n                                <span className=\"truncate w-full text-gray-800 dark:text-gray-200 pointer-events-none\">\r\n                                    {row[h]}\r\n                                </span>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Footer */}\r\n      <div className=\"px-3 py-2 bg-[#f8f9fa] dark:bg-[#252525] border-t border-gray-300 dark:border-[#444] flex justify-between items-center\">\r\n        <span className=\"text-[10px] font-medium text-gray-500 dark:text-gray-400\">\r\n           {rows.length < data.rows.length ? `Previewing ${rows.length} of ${data.rows.length} rows` : `${rows.length} rows`}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n"],"names":[],"mappings":";;;;AACA;AAEA;AAAA;AAAA;;;;AAUO,MAAM,gBAA8C,CAAC,EAAE,IAAI,EAAE,QAAQ,EAAE,UAAU,EAAE,MAAM,EAAE,QAAQ,EAAE;IAC1G,uCAAuC;IACvC,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAS,EAAE;IAC1C,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAY,EAAE;IACnD,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAA0B,CAAC;IAEpE,oBAAoB;IACpB,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAiC;IAEhF,iBAAiB;IACjB,MAAM,cAAc,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAiE;IAE1F,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,gDAAgD;QAChD,QAAQ,KAAK,IAAI,CAAC,KAAK,CAAC,GAAG,KAAK,0CAA0C;QAC1E,WAAW,KAAK,OAAO;QAEvB,oBAAoB;QACpB,MAAM,gBAAwC,CAAC;QAC/C,KAAK,OAAO,CAAC,OAAO,CAAC,CAAA,IAAK,aAAa,CAAC,EAAE,GAAG;QAC7C,aAAa;IACf,GAAG;QAAC;KAAK;IAET,yBAAyB;IACzB,MAAM,kBAAkB,CAAC,GAAqB;QAC5C,EAAE,cAAc;QAChB,YAAY,OAAO,GAAG;YACpB,QAAQ,EAAE,OAAO;YACjB,YAAY,SAAS,CAAC,OAAO,IAAI;YACjC;QACF;QACA,SAAS,gBAAgB,CAAC,aAAa;QACvC,SAAS,gBAAgB,CAAC,WAAW;IACvC;IAEA,MAAM,kBAAkB,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EAAE,CAAC;QACnC,IAAI,CAAC,YAAY,OAAO,EAAE;QAC1B,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,MAAM,EAAE,GAAG,YAAY,OAAO;QAC1D,MAAM,OAAO,EAAE,OAAO,GAAG;QACzB,aAAa,CAAA,OAAQ,CAAC;gBACpB,GAAG,IAAI;gBACP,CAAC,OAAO,EAAE,KAAK,GAAG,CAAC,IAAI,aAAa;YACtC,CAAC;IACH,GAAG,EAAE;IAEL,MAAM,gBAAgB,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EAAE;QAChC,YAAY,OAAO,GAAG;QACtB,SAAS,mBAAmB,CAAC,aAAa;QAC1C,SAAS,mBAAmB,CAAC,WAAW;IAC1C,GAAG;QAAC;KAAgB;IAEpB,4BAA4B;IAC5B,MAAM,kBAAkB,CAAC,GAAW;QAClC,gBAAgB;YAAE;YAAG;QAAE;IACzB;IAEA,2CAA2C;IAC3C,MAAM,eAAe,CAAC,QAAkB,OAAO,YAAY,CAAC,KAAK;IAEjE,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBAAI,WAAU;;0CACb,8OAAC;gCAAI,WAAW,CAAC,kEAAkE,EAAE,aAAa,kBAAkB,gBAAgB;0CAChI,2BAAa,8OAAC,kNAAA,CAAA,YAAS;oCAAC,MAAM;oCAAI,WAAU;;;;;yDAAkB,8OAAC,0MAAA,CAAA,WAAQ;oCAAC,MAAM;oCAAI,WAAU;;;;;;;;;;;0CAEhG,8OAAC;gCAAI,WAAU;;kDACZ,8OAAC;wCAAI,WAAU;;0DACZ,8OAAC;gDAAK,WAAU;0DAAmE;;;;;;4CAClF,wBACG,8OAAC;gDAAK,WAAU;0DACX;;;;;;;;;;;;oCAIX,4BAAc,8OAAC;wCAAK,WAAU;kDAAoF;;;;;;;;;;;;;;;;;;kCAGxH,8OAAC;wBACG,SAAS;wBACT,WAAU;;0CAEV,8OAAC,gNAAA,CAAA,YAAS;gCAAC,MAAM;gCAAI,aAAa;;;;;;0CAClC,8OAAC;gCAAK,WAAU;0CAAmB;;;;;;;;;;;;;;;;;;0BAKzC,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAI,WAAU;;sCAEX,8OAAC;4BAAI,WAAU;;8CAEX,8OAAC;oCAAI,WAAU;;;;;;gCACd,QAAQ,GAAG,CAAC,CAAC,GAAG,kBACb,8OAAC;wCAEG,WAAU;wCACV,OAAO;4CAAE,OAAO,SAAS,CAAC,EAAE;wCAAC;;4CAE5B;4CAAE;4CAAG,aAAa;4CAAG;0DAEtB,8OAAC;gDACG,WAAU;gDACV,aAAa,CAAC,IAAM,gBAAgB,GAAG;;;;;;;uCARtC;;;;;;;;;;;wBAehB,KAAK,GAAG,CAAC,CAAC,KAAK,qBACZ,8OAAC;gCAAe,WAAU;;kDAEtB,8OAAC;wCAAI,WAAU;kDACV,OAAO;;;;;;oCAIX,QAAQ,GAAG,CAAC,CAAC;wCACV,MAAM,aAAa,cAAc,MAAM,QAAQ,cAAc,MAAM;wCAEnE,qBACI,8OAAC;4CAEG,WAAW,CAAC;;oCAER,EAAE,OAAO,MAAM,IAAI,+BAA+B,iCAAiC;oCACnF,EAAE,aAAa,6CAA6C,GAAG;gCACnE,CAAC;4CACD,OAAO;gDAAE,OAAO,SAAS,CAAC,EAAE;4CAAC;4CAC7B,SAAS,IAAM,gBAAgB,MAAM;sDAErC,cAAA,8OAAC;gDAAK,WAAU;0DACX,GAAG,CAAC,EAAE;;;;;;2CAVN;;;;;oCAcjB;;+BA1BM;;;;;;;;;;;;;;;;0BAiCpB,8OAAC;gBAAI,WAAU;0BACb,cAAA,8OAAC;oBAAK,WAAU;8BACZ,KAAK,MAAM,GAAG,KAAK,IAAI,CAAC,MAAM,GAAG,CAAC,WAAW,EAAE,KAAK,MAAM,CAAC,IAAI,EAAE,KAAK,IAAI,CAAC,MAAM,CAAC,KAAK,CAAC,GAAG,GAAG,KAAK,MAAM,CAAC,KAAK,CAAC;;;;;;;;;;;;;;;;;AAK5H","debugId":null}},
    {"offset": {"line": 312, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/components/table/views/DataGridView.tsx"],"sourcesContent":["\r\n\r\nimport React, { useState, useCallback, useRef, useEffect } from 'react';\r\nimport { Plus, Filter, Trash2 } from 'lucide-react';\r\n\r\ninterface DataGridViewProps {\r\n  headers: string[];\r\n  rows: any[];\r\n  onRowUpdate: (id: string, updates: Record<string, any>) => void;\r\n  onAddRow: () => void;\r\n  onDeleteRow: (id: string) => void;\r\n  filters: Record<string, string>;\r\n  setFilters: (filters: Record<string, string>) => void;\r\n  sortConfig: { key: string; dir: 'asc' | 'desc' } | null;\r\n  setSortConfig: (config: { key: string; dir: 'asc' | 'desc' } | null) => void;\r\n}\r\n\r\nexport const DataGridView: React.FC<DataGridViewProps> = ({\r\n  headers,\r\n  rows,\r\n  onRowUpdate,\r\n  onAddRow,\r\n  onDeleteRow,\r\n  filters,\r\n  setFilters,\r\n  sortConfig,\r\n  setSortConfig,\r\n}) => {\r\n  const [selectedCell, setSelectedCell] = useState<{ r: number; c: string } | null>(null);\r\n  const [colWidths, setColWidths] = useState<Record<string, number>>({});\r\n  const resizingRef = useRef<{ startX: number; startWidth: number; header: string } | null>(null);\r\n  \r\n  // Lazy Loading State\r\n  const [visibleCount, setVisibleCount] = useState(50);\r\n  const scrollContainerRef = useRef<HTMLDivElement>(null);\r\n\r\n  // Initial width setup\r\n  useEffect(() => {\r\n    const widths: Record<string, number> = {};\r\n    headers.forEach((h) => (widths[h] = 150));\r\n    setColWidths(widths);\r\n  }, [headers]);\r\n\r\n  // Reset lazy load on filter/sort/data change\r\n  useEffect(() => {\r\n    setVisibleCount(50);\r\n    if (scrollContainerRef.current) {\r\n      scrollContainerRef.current.scrollTop = 0;\r\n    }\r\n  }, [filters, sortConfig, rows.length]);\r\n\r\n  const handleCellEdit = (id: string, key: string, val: string) => {\r\n    onRowUpdate(id, { [key]: val });\r\n  };\r\n\r\n  // Scroll Handler for Lazy Loading\r\n  const handleScroll = useCallback((e: React.UIEvent<HTMLDivElement>) => {\r\n    const { scrollTop, scrollHeight, clientHeight } = e.currentTarget;\r\n    // Load more when within 200px of bottom\r\n    if (scrollHeight - scrollTop <= clientHeight + 200) {\r\n      if (visibleCount < rows.length) {\r\n         setVisibleCount(prev => Math.min(prev + 50, rows.length));\r\n      }\r\n    }\r\n  }, [rows.length, visibleCount]);\r\n\r\n  // Resizing Logic\r\n  const handleResizeMouseDown = (e: React.MouseEvent, header: string) => {\r\n    e.preventDefault();\r\n    e.stopPropagation();\r\n    resizingRef.current = { startX: e.clientX, startWidth: colWidths[header] || 150, header };\r\n    document.addEventListener('mousemove', handleResizeMouseMove);\r\n    document.addEventListener('mouseup', handleResizeMouseUp);\r\n  };\r\n\r\n  const handleResizeMouseMove = useCallback((e: MouseEvent) => {\r\n    if (!resizingRef.current) return;\r\n    const { startX, startWidth, header } = resizingRef.current;\r\n    const diff = e.clientX - startX;\r\n    setColWidths((prev) => ({ ...prev, [header]: Math.max(60, startWidth + diff) }));\r\n  }, []);\r\n\r\n  const handleResizeMouseUp = useCallback(() => {\r\n    resizingRef.current = null;\r\n    document.removeEventListener('mousemove', handleResizeMouseMove);\r\n    document.removeEventListener('mouseup', handleResizeMouseUp);\r\n  }, [handleResizeMouseMove]);\r\n\r\n  const visibleRows = rows.slice(0, visibleCount);\r\n\r\n  return (\r\n    <div className=\"flex flex-col h-full bg-[#F5F5F7] dark:bg-[#1e1e1e]\">\r\n      {/* Toolbar */}\r\n      <div className=\"flex items-center gap-2 p-2 border-b border-gray-200 dark:border-[#333] bg-white/80 dark:bg-[#252525]/80 backdrop-blur-sm flex-shrink-0\">\r\n        <button\r\n          onClick={onAddRow}\r\n          className=\"flex items-center gap-1 px-3 py-1.5 text-xs font-medium bg-white dark:bg-[#333] border border-gray-200 dark:border-[#444] hover:bg-gray-50 dark:hover:bg-[#444] text-gray-700 dark:text-gray-200 transition-colors rounded-md shadow-sm\"\r\n        >\r\n          <Plus size={14} /> Row\r\n        </button>\r\n        <div className=\"h-4 w-px bg-gray-300 dark:bg-[#444]\"></div>\r\n        <button\r\n          onClick={() => setFilters({})}\r\n          className=\"flex items-center gap-1 px-3 py-1.5 text-xs font-medium bg-white dark:bg-[#333] border border-gray-200 dark:border-[#444] hover:bg-gray-50 dark:hover:bg-[#444] text-gray-700 dark:text-gray-200 transition-colors rounded-md shadow-sm\"\r\n        >\r\n          <Filter size={14} /> Clear Filters\r\n        </button>\r\n        <span className=\"ml-auto text-xs text-gray-500\">\r\n           Showing {visibleRows.length} of {rows.length} rows\r\n        </span>\r\n      </div>\r\n\r\n      {/* Table Area */}\r\n      <div \r\n        className=\"flex-1 overflow-auto custom-scrollbar bg-[#F5F5F7] dark:bg-[#1e1e1e] p-4\"\r\n        onScroll={handleScroll}\r\n        ref={scrollContainerRef}\r\n      >\r\n        <div className=\"inline-block min-w-full bg-white dark:bg-[#1e1e1e] rounded-lg border border-gray-200 dark:border-[#333] shadow-sm overflow-hidden\">\r\n          {/* Headers */}\r\n          <div className=\"flex sticky top-0 z-20\">\r\n            <div className=\"w-10 flex-shrink-0 bg-gray-50 dark:bg-[#2b2b2b] border-r border-b border-gray-200 dark:border-[#444] h-8\"></div>\r\n            {headers.map((h) => (\r\n              <div\r\n                key={h}\r\n                className=\"relative flex-shrink-0 flex flex-col justify-center bg-gray-50 dark:bg-[#2b2b2b] border-r border-b border-gray-200 dark:border-[#444] h-8 px-2 group\"\r\n                style={{ width: colWidths[h] }}\r\n              >\r\n                <div className=\"flex items-center justify-between text-[11px] font-semibold text-gray-600 dark:text-gray-300 select-none\">\r\n                  <span\r\n                    onClick={() =>\r\n                      setSortConfig({\r\n                        key: h,\r\n                        dir: sortConfig?.key === h && sortConfig.dir === 'asc' ? 'desc' : 'asc',\r\n                      })\r\n                    }\r\n                    className=\"cursor-pointer hover:text-black dark:hover:text-white\"\r\n                  >\r\n                    {h} {sortConfig?.key === h && (sortConfig.dir === 'asc' ? '↑' : '↓')}\r\n                  </span>\r\n                </div>\r\n                <div\r\n                  className=\"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-blue-500 z-30\"\r\n                  onMouseDown={(e) => handleResizeMouseDown(e, h)}\r\n                />\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          {/* Filter Row */}\r\n          <div className=\"flex sticky top-8 z-20 bg-white dark:bg-[#252525]\">\r\n            <div className=\"w-10 flex-shrink-0 bg-white dark:bg-[#252525] border-r border-b border-gray-200 dark:border-[#444] h-8 flex items-center justify-center\">\r\n              <Filter size={10} className=\"text-gray-400\" />\r\n            </div>\r\n            {headers.map((h) => (\r\n              <div\r\n                key={`filter-${h}`}\r\n                className=\"flex-shrink-0 border-r border-b border-gray-200 dark:border-[#444] h-8 p-0\"\r\n                style={{ width: colWidths[h] }}\r\n              >\r\n                <input\r\n                  className=\"w-full h-full px-2 text-xs bg-transparent outline-none text-gray-600 dark:text-gray-300 placeholder-gray-300\"\r\n                  placeholder=\"Filter...\"\r\n                  value={filters[h] || ''}\r\n                  onChange={(e) => setFilters({ ...filters, [h]: e.target.value })}\r\n                />\r\n              </div>\r\n            ))}\r\n          </div>\r\n\r\n          {/* Data Rows (Virtualized/Lazy Loaded Slice) */}\r\n          {visibleRows.map((row, rIdx) => (\r\n            <div key={row.id} className=\"flex group hover:bg-blue-50/50 dark:hover:bg-[#333] transition-colors\">\r\n              <div className=\"w-10 flex-shrink-0 bg-gray-50 dark:bg-[#2b2b2b] border-r border-b border-gray-100 dark:border-[#444] text-[10px] flex items-center justify-center text-gray-400 dark:text-gray-500 select-none font-mono group-hover:bg-gray-100 dark:group-hover:bg-[#383838] relative\">\r\n                {rIdx + 1}\r\n                <button\r\n                  onClick={() => onDeleteRow(row.id)}\r\n                  className=\"absolute left-0.5 top-1/2 -translate-y-1/2 opacity-0 group-hover:opacity-100 text-red-500 p-1\"\r\n                >\r\n                  <Trash2 size={10} />\r\n                </button>\r\n              </div>\r\n              {headers.map((h) => {\r\n                const isSelected = selectedCell?.r === rIdx && selectedCell?.c === h;\r\n                return (\r\n                  <div\r\n                    key={`${row.id}-${h}`}\r\n                    className={`flex-shrink-0 border-r border-b border-gray-100 dark:border-[#444] h-8 p-0 relative ${\r\n                      rIdx % 2 === 0 ? 'bg-white dark:bg-[#1e1e1e]' : 'bg-[#fafbfc] dark:bg-[#232323]'\r\n                    } ${isSelected ? 'ring-2 ring-inset ring-blue-500 z-10' : ''}`}\r\n                    style={{ width: colWidths[h] }}\r\n                    onClick={() => setSelectedCell({ r: rIdx, c: h })}\r\n                  >\r\n                    <input\r\n                      className=\"w-full h-full px-2 bg-transparent border-none outline-none text-xs font-sans text-gray-800 dark:text-gray-200\"\r\n                      value={row[h] || ''}\r\n                      onChange={(e) => handleCellEdit(row.id, h, e.target.value)}\r\n                    />\r\n                  </div>\r\n                );\r\n              })}\r\n            </div>\r\n          ))}\r\n          {/* Lazy Load Spinner */}\r\n          {visibleCount < rows.length && (\r\n             <div className=\"flex justify-center p-4 bg-gray-50 dark:bg-[#252525]\">\r\n                <div className=\"w-4 h-4 border-2 border-gray-300 border-t-blue-500 rounded-full animate-spin\"></div>\r\n             </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};"],"names":[],"mappings":";;;;AAEA;AACA;AAAA;AAAA;;;;AAcO,MAAM,eAA4C,CAAC,EACxD,OAAO,EACP,IAAI,EACJ,WAAW,EACX,QAAQ,EACR,WAAW,EACX,OAAO,EACP,UAAU,EACV,UAAU,EACV,aAAa,EACd;IACC,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAmC;IAClF,MAAM,CAAC,WAAW,aAAa,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAA0B,CAAC;IACpE,MAAM,cAAc,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAiE;IAE1F,qBAAqB;IACrB,MAAM,CAAC,cAAc,gBAAgB,GAAG,CAAA,GAAA,qMAAA,CAAA,WAAQ,AAAD,EAAE;IACjD,MAAM,qBAAqB,CAAA,GAAA,qMAAA,CAAA,SAAM,AAAD,EAAkB;IAElD,sBAAsB;IACtB,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,MAAM,SAAiC,CAAC;QACxC,QAAQ,OAAO,CAAC,CAAC,IAAO,MAAM,CAAC,EAAE,GAAG;QACpC,aAAa;IACf,GAAG;QAAC;KAAQ;IAEZ,6CAA6C;IAC7C,CAAA,GAAA,qMAAA,CAAA,YAAS,AAAD,EAAE;QACR,gBAAgB;QAChB,IAAI,mBAAmB,OAAO,EAAE;YAC9B,mBAAmB,OAAO,CAAC,SAAS,GAAG;QACzC;IACF,GAAG;QAAC;QAAS;QAAY,KAAK,MAAM;KAAC;IAErC,MAAM,iBAAiB,CAAC,IAAY,KAAa;QAC/C,YAAY,IAAI;YAAE,CAAC,IAAI,EAAE;QAAI;IAC/B;IAEA,kCAAkC;IAClC,MAAM,eAAe,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EAAE,CAAC;QAChC,MAAM,EAAE,SAAS,EAAE,YAAY,EAAE,YAAY,EAAE,GAAG,EAAE,aAAa;QACjE,wCAAwC;QACxC,IAAI,eAAe,aAAa,eAAe,KAAK;YAClD,IAAI,eAAe,KAAK,MAAM,EAAE;gBAC7B,gBAAgB,CAAA,OAAQ,KAAK,GAAG,CAAC,OAAO,IAAI,KAAK,MAAM;YAC1D;QACF;IACF,GAAG;QAAC,KAAK,MAAM;QAAE;KAAa;IAE9B,iBAAiB;IACjB,MAAM,wBAAwB,CAAC,GAAqB;QAClD,EAAE,cAAc;QAChB,EAAE,eAAe;QACjB,YAAY,OAAO,GAAG;YAAE,QAAQ,EAAE,OAAO;YAAE,YAAY,SAAS,CAAC,OAAO,IAAI;YAAK;QAAO;QACxF,SAAS,gBAAgB,CAAC,aAAa;QACvC,SAAS,gBAAgB,CAAC,WAAW;IACvC;IAEA,MAAM,wBAAwB,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EAAE,CAAC;QACzC,IAAI,CAAC,YAAY,OAAO,EAAE;QAC1B,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,MAAM,EAAE,GAAG,YAAY,OAAO;QAC1D,MAAM,OAAO,EAAE,OAAO,GAAG;QACzB,aAAa,CAAC,OAAS,CAAC;gBAAE,GAAG,IAAI;gBAAE,CAAC,OAAO,EAAE,KAAK,GAAG,CAAC,IAAI,aAAa;YAAM,CAAC;IAChF,GAAG,EAAE;IAEL,MAAM,sBAAsB,CAAA,GAAA,qMAAA,CAAA,cAAW,AAAD,EAAE;QACtC,YAAY,OAAO,GAAG;QACtB,SAAS,mBAAmB,CAAC,aAAa;QAC1C,SAAS,mBAAmB,CAAC,WAAW;IAC1C,GAAG;QAAC;KAAsB;IAE1B,MAAM,cAAc,KAAK,KAAK,CAAC,GAAG;IAElC,qBACE,8OAAC;QAAI,WAAU;;0BAEb,8OAAC;gBAAI,WAAU;;kCACb,8OAAC;wBACC,SAAS;wBACT,WAAU;;0CAEV,8OAAC,kMAAA,CAAA,OAAI;gCAAC,MAAM;;;;;;4BAAM;;;;;;;kCAEpB,8OAAC;wBAAI,WAAU;;;;;;kCACf,8OAAC;wBACC,SAAS,IAAM,WAAW,CAAC;wBAC3B,WAAU;;0CAEV,8OAAC,sMAAA,CAAA,SAAM;gCAAC,MAAM;;;;;;4BAAM;;;;;;;kCAEtB,8OAAC;wBAAK,WAAU;;4BAAgC;4BACpC,YAAY,MAAM;4BAAC;4BAAK,KAAK,MAAM;4BAAC;;;;;;;;;;;;;0BAKlD,8OAAC;gBACC,WAAU;gBACV,UAAU;gBACV,KAAK;0BAEL,cAAA,8OAAC;oBAAI,WAAU;;sCAEb,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;;;;;;gCACd,QAAQ,GAAG,CAAC,CAAC,kBACZ,8OAAC;wCAEC,WAAU;wCACV,OAAO;4CAAE,OAAO,SAAS,CAAC,EAAE;wCAAC;;0DAE7B,8OAAC;gDAAI,WAAU;0DACb,cAAA,8OAAC;oDACC,SAAS,IACP,cAAc;4DACZ,KAAK;4DACL,KAAK,YAAY,QAAQ,KAAK,WAAW,GAAG,KAAK,QAAQ,SAAS;wDACpE;oDAEF,WAAU;;wDAET;wDAAE;wDAAE,YAAY,QAAQ,KAAK,CAAC,WAAW,GAAG,KAAK,QAAQ,MAAM,GAAG;;;;;;;;;;;;0DAGvE,8OAAC;gDACC,WAAU;gDACV,aAAa,CAAC,IAAM,sBAAsB,GAAG;;;;;;;uCAnB1C;;;;;;;;;;;sCA0BX,8OAAC;4BAAI,WAAU;;8CACb,8OAAC;oCAAI,WAAU;8CACb,cAAA,8OAAC,sMAAA,CAAA,SAAM;wCAAC,MAAM;wCAAI,WAAU;;;;;;;;;;;gCAE7B,QAAQ,GAAG,CAAC,CAAC,kBACZ,8OAAC;wCAEC,WAAU;wCACV,OAAO;4CAAE,OAAO,SAAS,CAAC,EAAE;wCAAC;kDAE7B,cAAA,8OAAC;4CACC,WAAU;4CACV,aAAY;4CACZ,OAAO,OAAO,CAAC,EAAE,IAAI;4CACrB,UAAU,CAAC,IAAM,WAAW;oDAAE,GAAG,OAAO;oDAAE,CAAC,EAAE,EAAE,EAAE,MAAM,CAAC,KAAK;gDAAC;;;;;;uCAR3D,CAAC,OAAO,EAAE,GAAG;;;;;;;;;;;wBAevB,YAAY,GAAG,CAAC,CAAC,KAAK,qBACrB,8OAAC;gCAAiB,WAAU;;kDAC1B,8OAAC;wCAAI,WAAU;;4CACZ,OAAO;0DACR,8OAAC;gDACC,SAAS,IAAM,YAAY,IAAI,EAAE;gDACjC,WAAU;0DAEV,cAAA,8OAAC,0MAAA,CAAA,SAAM;oDAAC,MAAM;;;;;;;;;;;;;;;;;oCAGjB,QAAQ,GAAG,CAAC,CAAC;wCACZ,MAAM,aAAa,cAAc,MAAM,QAAQ,cAAc,MAAM;wCACnE,qBACE,8OAAC;4CAEC,WAAW,CAAC,oFAAoF,EAC9F,OAAO,MAAM,IAAI,+BAA+B,iCACjD,CAAC,EAAE,aAAa,yCAAyC,IAAI;4CAC9D,OAAO;gDAAE,OAAO,SAAS,CAAC,EAAE;4CAAC;4CAC7B,SAAS,IAAM,gBAAgB;oDAAE,GAAG;oDAAM,GAAG;gDAAE;sDAE/C,cAAA,8OAAC;gDACC,WAAU;gDACV,OAAO,GAAG,CAAC,EAAE,IAAI;gDACjB,UAAU,CAAC,IAAM,eAAe,IAAI,EAAE,EAAE,GAAG,EAAE,MAAM,CAAC,KAAK;;;;;;2CAVtD,GAAG,IAAI,EAAE,CAAC,CAAC,EAAE,GAAG;;;;;oCAc3B;;+BA5BQ,IAAI,EAAE;;;;;wBAgCjB,eAAe,KAAK,MAAM,kBACxB,8OAAC;4BAAI,WAAU;sCACZ,cAAA,8OAAC;gCAAI,WAAU;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAO/B","debugId":null}},
    {"offset": {"line": 676, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/utils/tableUtils.ts"],"sourcesContent":["\r\nimport { TableData } from \"../types/chat\";\r\n\r\nexport const parseCSV = (text: string): TableData => {\r\n  const lines = text.split('\\n').filter(l => l.trim());\r\n  if (lines.length === 0) return { headers: [], rows: [] };\r\n  \r\n  // Simple CSV parser (does not handle quoted commas for this prototype)\r\n  const headers = lines[0].split(',').map(h => h.trim());\r\n  const rows = lines.slice(1).map((line, idx) => {\r\n    const values = line.split(',');\r\n    const row: any = { id: `row-${idx}` }; // Add internal ID\r\n    headers.forEach((h, i) => {\r\n      let val: string | number = values[i]?.trim();\r\n      // Attempt number conversion\r\n      if (!isNaN(Number(val)) && val !== '') {\r\n        val = Number(val);\r\n      }\r\n      row[h] = val;\r\n    });\r\n    return row;\r\n  });\r\n  \r\n  return { headers, rows };\r\n};\r\n\r\nexport const parseJSON = (text: string): TableData => {\r\n  try {\r\n    const data = JSON.parse(text);\r\n    if (Array.isArray(data) && data.length > 0) {\r\n      const headers = Object.keys(data[0]);\r\n      const rows = data.map((row: any, idx: number) => ({ ...row, id: `row-${idx}` }));\r\n      return { headers, rows };\r\n    }\r\n  } catch (e) {\r\n    console.error(\"Failed to parse JSON\", e);\r\n  }\r\n  return { headers: [], rows: [] };\r\n};\r\n\r\nexport const exportToCSV = (data: TableData): string => {\r\n  const headerLine = data.headers.join(',');\r\n  const rowLines = data.rows.map(row => {\r\n    return data.headers.map(h => row[h]).join(',');\r\n  });\r\n  return [headerLine, ...rowLines].join('\\n');\r\n};\r\n\r\n// Pivot Logic\r\nexport interface PivotConfig {\r\n  rows: string[];\r\n  columns: string[];\r\n  values: string[];\r\n  aggregation: 'sum' | 'count' | 'average' | 'min' | 'max';\r\n}\r\n\r\nexport const generatePivot = (data: any[], config: PivotConfig) => {\r\n  const { rows, columns, values, aggregation } = config;\r\n  \r\n  // Allow generation if at least Rows OR Columns are specified. \r\n  // If Values are empty, we will just count the occurrences.\r\n  if (rows.length === 0 && columns.length === 0) return null;\r\n\r\n  const pivotData: any = {};\r\n  const colKeys = new Set<string>();\r\n\r\n  data.forEach(item => {\r\n    const rowKey = rows.length > 0 ? rows.map(r => item[r]).join(' - ') : 'Total';\r\n    const colKey = columns.length > 0 ? columns.map(c => item[c]).join(' - ') : 'Total';\r\n    \r\n    if (columns.length > 0) colKeys.add(colKey);\r\n    else colKeys.add('Total'); // Default column if none selected\r\n\r\n    if (!pivotData[rowKey]) pivotData[rowKey] = { name: rowKey };\r\n    if (!pivotData[rowKey][colKey]) pivotData[rowKey][colKey] = [];\r\n\r\n    if (values.length > 0) {\r\n        pivotData[rowKey][colKey].push(item[values[0]]);\r\n    } else {\r\n        // If no value column is selected, we treat existence as 1 for counting\r\n        pivotData[rowKey][colKey].push(1);\r\n    }\r\n  });\r\n\r\n  const result: any[] = [];\r\n  Object.keys(pivotData).forEach(rowKey => {\r\n    const rowObj: any = { name: rowKey };\r\n    const allColKeys = Array.from(colKeys);\r\n    \r\n    allColKeys.forEach(colKey => {\r\n       const vals = pivotData[rowKey][colKey] || [];\r\n       let aggVal = 0;\r\n       \r\n       // If no values were selected, force aggregation to count (or sum of 1s)\r\n       const effectiveAgg = values.length === 0 ? 'count' : aggregation;\r\n\r\n       if (effectiveAgg === 'count') aggVal = vals.length;\r\n       else if (effectiveAgg === 'sum') aggVal = vals.reduce((a: number, b: number) => a + Number(b), 0);\r\n       else if (effectiveAgg === 'average') aggVal = vals.length ? vals.reduce((a: number, b: number) => a + Number(b), 0) / vals.length : 0;\r\n       else if (effectiveAgg === 'min') aggVal = vals.length ? Math.min(...vals) : 0;\r\n       else if (effectiveAgg === 'max') aggVal = vals.length ? Math.max(...vals) : 0;\r\n       \r\n       rowObj[colKey] = parseFloat(aggVal.toFixed(2));\r\n    });\r\n    result.push(rowObj);\r\n  });\r\n\r\n  return { data: result, columns: Array.from(colKeys) };\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 796, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/components/table/types.ts"],"sourcesContent":["\r\nexport interface NotebookBlock {\r\n  type: 'text' | 'chart' | 'stat';\r\n  content?: string; // For text\r\n  title?: string;\r\n  // For charts\r\n  chartType?: 'bar' | 'line' | 'pie' | 'area';\r\n  xAxis?: string;\r\n  yAxis?: string;\r\n  aggregation?: 'sum' | 'count' | 'average';\r\n  explanation?: string;\r\n  // For stats\r\n  statValue?: string;\r\n  statLabel?: string;\r\n  trend?: 'up' | 'down' | 'neutral';\r\n}\r\n\r\nexport interface NotebookReport {\r\n  title: string;\r\n  summary: string;\r\n  blocks: NotebookBlock[];\r\n}\r\n\r\nexport const COLOR_THEMES: Record<string, string[]> = {\r\n  green: ['#107c41', '#21a366', '#33c481', '#185c37', '#0b5a2d'],\r\n  blue: ['#007AFF', '#5856D6', '#00C7BE', '#32ADE6', '#007AFF'],\r\n  purple: ['#AF52DE', '#BF5AF2', '#DA8FFF', '#5E5CE6', '#7D54DE'],\r\n  orange: ['#FF9500', '#FF3B30', '#FF2D55', '#FFCC00', '#FF9500'],\r\n  gray: ['#8E8E93', '#AEAEB2', '#C7C7CC', '#48484A', '#1C1C1E'],\r\n};\r\n"],"names":[],"mappings":";;;AAuBO,MAAM,eAAyC;IACpD,OAAO;QAAC;QAAW;QAAW;QAAW;QAAW;KAAU;IAC9D,MAAM;QAAC;QAAW;QAAW;QAAW;QAAW;KAAU;IAC7D,QAAQ;QAAC;QAAW;QAAW;QAAW;QAAW;KAAU;IAC/D,QAAQ;QAAC;QAAW;QAAW;QAAW;QAAW;KAAU;IAC/D,MAAM;QAAC;QAAW;QAAW;QAAW;QAAW;KAAU;AAC/D","debugId":null}},
    {"offset": {"line": 842, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/components/table/views/PivotView.tsx"],"sourcesContent":["\r\n\r\nimport React, { useMemo, useState } from 'react';\r\nimport { Grid, X, Palette, Table as TableIcon } from 'lucide-react';\r\nimport { generatePivot, PivotConfig } from '../../../utils/tableUtils';\r\nimport { COLOR_THEMES } from '../types';\r\n\r\ninterface PivotViewProps {\r\n  headers: string[];\r\n  rows: any[];\r\n  config: PivotConfig;\r\n  setConfig: (config: PivotConfig) => void;\r\n}\r\n\r\nexport const PivotView: React.FC<PivotViewProps> = ({ headers, rows, config, setConfig }) => {\r\n  const [themeColor, setThemeColor] = useState<string>('blue');\r\n  const [showLabels, setShowLabels] = useState(false);\r\n\r\n  const pivotResult = useMemo(() => {\r\n    return generatePivot(rows, config);\r\n  }, [rows, config]);\r\n\r\n  const handlePivotDrag = (field: string, target: 'rows' | 'columns' | 'values') => {\r\n    setConfig({\r\n      ...config,\r\n      rows: config.rows.filter((f) => f !== field),\r\n      columns: config.columns.filter((f) => f !== field),\r\n      values: config.values.filter((f) => f !== field),\r\n      [target]: [...config[target], field]\r\n    });\r\n  };\r\n\r\n  const removeField = (field: string, target: 'rows' | 'columns' | 'values') => {\r\n      setConfig({\r\n          ...config,\r\n          [target]: config[target].filter((f) => f !== field)\r\n      });\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex h-full bg-[#F5F5F7] dark:bg-[#1e1e1e]\">\r\n      {/* Config Sidebar */}\r\n      <div className=\"w-64 border-r border-gray-200 dark:border-[#333] flex flex-col bg-white dark:bg-[#252525] overflow-y-auto p-4\">\r\n        <h3 className=\"text-xs font-bold uppercase text-gray-400 mb-4 tracking-wider\">Pivot Settings</h3>\r\n\r\n        <div className=\"mb-6\">\r\n          <p className=\"text-xs font-semibold mb-2 text-gray-700 dark:text-gray-200\">Fields</p>\r\n          <div className=\"flex flex-col gap-1.5\">\r\n            {headers.map((h) => (\r\n              <div\r\n                key={h}\r\n                draggable\r\n                onDragStart={(e) => e.dataTransfer.setData('field', h)}\r\n                className=\"px-3 py-2 bg-white dark:bg-[#333] border border-gray-200 dark:border-[#444] rounded-md text-xs cursor-grab active:cursor-grabbing shadow-sm hover:bg-gray-50 dark:hover:bg-[#383838] flex items-center justify-between transition-all\"\r\n              >\r\n                <span>{h}</span>\r\n                <Grid size={12} className=\"text-gray-400\" />\r\n              </div>\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        {['rows', 'columns', 'values'].map((area) => (\r\n          <div\r\n            key={area}\r\n            className=\"mb-4 min-h-[80px] border border-dashed border-gray-300 dark:border-[#444] rounded-lg bg-gray-50/50 dark:bg-[#2a2a2a]\"\r\n            onDragOver={(e) => e.preventDefault()}\r\n            onDrop={(e) => {\r\n              const f = e.dataTransfer.getData('field');\r\n              if (f) handlePivotDrag(f, area as any);\r\n            }}\r\n          >\r\n            <div className=\"px-3 py-1.5 border-b border-gray-200 dark:border-[#444]\">\r\n              <p className=\"text-[10px] uppercase text-gray-500 font-bold\">{area}</p>\r\n            </div>\r\n            <div className=\"p-2 flex flex-col gap-1.5\">\r\n              {(config as any)[area].map((f: string) => (\r\n                <div\r\n                  key={f}\r\n                  className=\"flex justify-between items-center px-2.5 py-1.5 bg-white dark:bg-[#333] text-xs border border-gray-200 dark:border-[#444] rounded-md shadow-sm\"\r\n                >\r\n                  <span>{f}</span>\r\n                  <X\r\n                    size={12}\r\n                    className=\"cursor-pointer text-gray-400 hover:text-red-500\"\r\n                    onClick={() => removeField(f, area as any)}\r\n                  />\r\n                </div>\r\n              ))}\r\n              {(config as any)[area].length === 0 && (\r\n                <span className=\"text-[10px] text-gray-400 italic p-1 text-center\">Drop here</span>\r\n              )}\r\n            </div>\r\n          </div>\r\n        ))}\r\n\r\n        <div className=\"mt-2 mb-6\">\r\n          <label className=\"text-xs font-medium text-gray-700 dark:text-gray-300\">Aggregation</label>\r\n          <select\r\n            className=\"w-full mt-1 p-2 text-xs bg-white dark:bg-[#333] border border-gray-200 dark:border-[#444] rounded-md outline-none shadow-sm\"\r\n            value={config.aggregation}\r\n            onChange={(e) => setConfig({ ...config, aggregation: e.target.value as any })}\r\n          >\r\n            <option value=\"sum\">Sum</option>\r\n            <option value=\"count\">Count</option>\r\n            <option value=\"average\">Average</option>\r\n          </select>\r\n        </div>\r\n\r\n        <div className=\"mt-auto pt-4 border-t border-gray-200 dark:border-[#333] space-y-4\">\r\n          <div className=\"flex items-center justify-between\">\r\n            <label className=\"flex items-center gap-2 text-xs font-medium text-gray-700 dark:text-gray-300 cursor-pointer\">\r\n              <input\r\n                type=\"checkbox\"\r\n                checked={showLabels}\r\n                onChange={(e) => setShowLabels(e.target.checked)}\r\n                className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\r\n              />\r\n              Show Labels\r\n            </label>\r\n          </div>\r\n\r\n          <div>\r\n            <div className=\"flex items-center gap-2 mb-2\">\r\n              <Palette size={12} className=\"text-gray-400\" />\r\n              <span className=\"text-xs font-bold text-gray-400 uppercase\">Theme</span>\r\n            </div>\r\n            <div className=\"flex flex-wrap gap-1.5\">\r\n              {Object.keys(COLOR_THEMES).map((color) => (\r\n                <button\r\n                  key={color}\r\n                  onClick={() => setThemeColor(color)}\r\n                  className={`w-5 h-5 rounded-full transition-all ${\r\n                    themeColor === color ? 'ring-2 ring-offset-1 ring-gray-400' : 'hover:scale-110'\r\n                  }`}\r\n                  style={{ backgroundColor: COLOR_THEMES[color][0] }}\r\n                  title={color}\r\n                />\r\n              ))}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Result Area */}\r\n      <div className=\"flex-1 overflow-auto p-8 bg-[#F5F5F7] dark:bg-[#1e1e1e]\">\r\n        <div className=\"bg-white dark:bg-[#252525] border border-gray-200 dark:border-[#444] shadow-sm rounded-xl overflow-hidden min-h-[300px]\">\r\n          {pivotResult ? (\r\n            <table className=\"w-full border-collapse text-sm\">\r\n              <thead>\r\n                <tr\r\n                  className=\"border-b border-gray-200 dark:border-[#444]\"\r\n                  style={{ backgroundColor: COLOR_THEMES[themeColor][0] }}\r\n                >\r\n                  <th className=\"p-3 text-left font-semibold text-white border-r border-white/10\">\r\n                    {config.rows.join(' > ') || 'Total'}\r\n                  </th>\r\n                  {pivotResult.columns.map((c) => (\r\n                    <th key={c} className=\"p-3 font-semibold text-white border-r border-white/10 min-w-[100px]\">\r\n                      {c}\r\n                    </th>\r\n                  ))}\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {pivotResult.data.map((row, i) => (\r\n                  <tr\r\n                    key={i}\r\n                    className=\"hover:bg-gray-50 dark:hover:bg-[#2f2f2f] border-b border-gray-100 dark:border-[#444]\"\r\n                  >\r\n                    <td className=\"p-3 font-medium text-gray-900 dark:text-white border-r border-gray-100 dark:border-[#444]\">\r\n                      {row.name}\r\n                    </td>\r\n                    {pivotResult.columns.map((c) => (\r\n                      <td\r\n                        key={c}\r\n                        className=\"p-3 text-right font-mono text-gray-600 dark:text-gray-400 border-r border-gray-100 dark:border-[#444]\"\r\n                      >\r\n                        {row[c]}\r\n                        {showLabels && <span className=\"ml-1 text-[9px] text-gray-400\">({row[c]})</span>}\r\n                      </td>\r\n                    ))}\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          ) : (\r\n            <div className=\"h-[300px] flex flex-col items-center justify-center text-gray-400\">\r\n              <TableIcon size={48} strokeWidth={1} className=\"mb-4 opacity-20\" />\r\n              <p className=\"text-sm font-medium\">Configure pivot to see results</p>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1313, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/utils/imageHelpers.ts"],"sourcesContent":["\r\nexport const downloadSvgAsPng = (svgElement: SVGElement, fileName: string) => {\r\n  try {\r\n    const serializer = new XMLSerializer();\r\n    const svgString = serializer.serializeToString(svgElement);\r\n    \r\n    // Create a canvas\r\n    const canvas = document.createElement('canvas');\r\n    const ctx = canvas.getContext('2d');\r\n    \r\n    // Get dimensions from SVG or use bounding rect\r\n    const rect = svgElement.getBoundingClientRect();\r\n    const width = rect.width * 2; // 2x for Retina/High Res\r\n    const height = rect.height * 2;\r\n    \r\n    canvas.width = width;\r\n    canvas.height = height;\r\n    \r\n    const img = new Image();\r\n    const svgBlob = new Blob([svgString], { type: 'image/svg+xml;charset=utf-8' });\r\n    const url = URL.createObjectURL(svgBlob);\r\n    \r\n    img.onload = () => {\r\n      if (ctx) {\r\n        // White background\r\n        ctx.fillStyle = '#ffffff';\r\n        ctx.fillRect(0, 0, width, height);\r\n        \r\n        // Draw image\r\n        ctx.drawImage(img, 0, 0, width, height);\r\n        \r\n        // Download\r\n        const pngUrl = canvas.toDataURL('image/png');\r\n        const link = document.createElement('a');\r\n        link.href = pngUrl;\r\n        link.download = fileName.endsWith('.png') ? fileName : `${fileName}.png`;\r\n        document.body.appendChild(link);\r\n        link.click();\r\n        document.body.removeChild(link);\r\n        \r\n        URL.revokeObjectURL(url);\r\n      }\r\n    };\r\n    \r\n    img.src = url;\r\n  } catch (error) {\r\n    console.error('Failed to download image', error);\r\n  }\r\n};\r\n"],"names":[],"mappings":";;;AACO,MAAM,mBAAmB,CAAC,YAAwB;IACvD,IAAI;QACF,MAAM,aAAa,IAAI;QACvB,MAAM,YAAY,WAAW,iBAAiB,CAAC;QAE/C,kBAAkB;QAClB,MAAM,SAAS,SAAS,aAAa,CAAC;QACtC,MAAM,MAAM,OAAO,UAAU,CAAC;QAE9B,+CAA+C;QAC/C,MAAM,OAAO,WAAW,qBAAqB;QAC7C,MAAM,QAAQ,KAAK,KAAK,GAAG,GAAG,yBAAyB;QACvD,MAAM,SAAS,KAAK,MAAM,GAAG;QAE7B,OAAO,KAAK,GAAG;QACf,OAAO,MAAM,GAAG;QAEhB,MAAM,MAAM,IAAI;QAChB,MAAM,UAAU,IAAI,KAAK;YAAC;SAAU,EAAE;YAAE,MAAM;QAA8B;QAC5E,MAAM,MAAM,IAAI,eAAe,CAAC;QAEhC,IAAI,MAAM,GAAG;YACX,IAAI,KAAK;gBACP,mBAAmB;gBACnB,IAAI,SAAS,GAAG;gBAChB,IAAI,QAAQ,CAAC,GAAG,GAAG,OAAO;gBAE1B,aAAa;gBACb,IAAI,SAAS,CAAC,KAAK,GAAG,GAAG,OAAO;gBAEhC,WAAW;gBACX,MAAM,SAAS,OAAO,SAAS,CAAC;gBAChC,MAAM,OAAO,SAAS,aAAa,CAAC;gBACpC,KAAK,IAAI,GAAG;gBACZ,KAAK,QAAQ,GAAG,SAAS,QAAQ,CAAC,UAAU,WAAW,GAAG,SAAS,IAAI,CAAC;gBACxE,SAAS,IAAI,CAAC,WAAW,CAAC;gBAC1B,KAAK,KAAK;gBACV,SAAS,IAAI,CAAC,WAAW,CAAC;gBAE1B,IAAI,eAAe,CAAC;YACtB;QACF;QAEA,IAAI,GAAG,GAAG;IACZ,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,4BAA4B;IAC5C;AACF","debugId":null}},
    {"offset": {"line": 1365, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/components/table/views/VisualsView.tsx"],"sourcesContent":["\r\n\r\nimport React from 'react';\r\nimport { Download, PieChart } from 'lucide-react';\r\nimport {\r\n  BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer,\r\n  PieChart as RePieChart, Pie, Cell, Legend, LineChart, Line, LabelList\r\n} from 'recharts';\r\nimport { downloadSvgAsPng } from '../../../utils/imageHelpers';\r\nimport { COLOR_THEMES } from '../types';\r\n\r\ninterface VisualsConfig {\r\n  chartType: 'bar' | 'pie' | 'line';\r\n  themeColor: string;\r\n}\r\n\r\ninterface VisualsViewProps {\r\n  headers: string[];\r\n  rows: any[];\r\n  fileName: string;\r\n  config: VisualsConfig;\r\n  setConfig: (config: VisualsConfig) => void;\r\n}\r\n\r\nexport const VisualsView: React.FC<VisualsViewProps> = ({ headers, rows, fileName, config, setConfig }) => {\r\n  const { chartType, themeColor } = config;\r\n  const [showLabels, setShowLabels] = React.useState(false);\r\n\r\n  const getChartData = () => {\r\n    if (rows.length > 0) {\r\n      // Simple heuristic: Use first string col as label, all number cols as values\r\n      const labelKey = headers.find((h) => typeof rows[0][h] === 'string') || headers[0];\r\n      const valueKeys = headers.filter((h) => typeof rows[0][h] === 'number');\r\n      if (valueKeys.length > 0) {\r\n        return { data: rows, keys: valueKeys, labelKey };\r\n      }\r\n    }\r\n    return null;\r\n  };\r\n\r\n  const chartDataInfo = getChartData();\r\n\r\n  const handleDownloadVisual = () => {\r\n    const svg = document.querySelector('.recharts-wrapper svg');\r\n    if (svg) {\r\n      downloadSvgAsPng(svg as SVGElement, `${fileName}_visual.png`);\r\n    }\r\n  };\r\n\r\n  if (!chartDataInfo) {\r\n    return (\r\n      <div className=\"h-full flex flex-col items-center justify-center text-gray-400 bg-[#F5F5F7] dark:bg-[#1e1e1e]\">\r\n        <PieChart size={48} strokeWidth={1} className=\"mb-4 opacity-20\" />\r\n        <p>Visuals require numeric data.</p>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  const { data: chartData, keys: dataKeys, labelKey } = chartDataInfo;\r\n  const colors = COLOR_THEMES[themeColor];\r\n\r\n  return (\r\n    <div className=\"h-full p-8 bg-[#F5F5F7] dark:bg-[#1e1e1e] overflow-y-auto flex flex-col\">\r\n      <div className=\"flex items-center justify-between mb-6\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <div className=\"flex items-center gap-1 p-1 bg-white dark:bg-[#252525] rounded-lg border border-gray-200 dark:border-[#444] shadow-sm\">\r\n            {['bar', 'line', 'pie'].map((type) => (\r\n              <button\r\n                key={type}\r\n                onClick={() => setConfig({ ...config, chartType: type as any })}\r\n                className={`px-4 py-1.5 text-xs font-medium rounded-md transition-all uppercase tracking-wide ${\r\n                  chartType === type\r\n                    ? 'bg-gray-100 dark:bg-[#333] text-black dark:text-white'\r\n                    : 'text-gray-500 dark:text-gray-400 hover:text-gray-800 dark:hover:text-gray-200'\r\n                }`}\r\n              >\r\n                {type}\r\n              </button>\r\n            ))}\r\n          </div>\r\n          <div className=\"flex items-center gap-1.5 px-2 py-1.5 bg-white dark:bg-[#252525] rounded-lg border border-gray-200 dark:border-[#444] shadow-sm\">\r\n            {Object.keys(COLOR_THEMES).map((color) => (\r\n              <button\r\n                key={color}\r\n                onClick={() => setConfig({ ...config, themeColor: color })}\r\n                className={`w-3 h-3 rounded-full transition-all ${\r\n                  themeColor === color ? 'scale-125 ring-1 ring-gray-400' : ''\r\n                }`}\r\n                style={{ backgroundColor: COLOR_THEMES[color][0] }}\r\n              />\r\n            ))}\r\n          </div>\r\n        </div>\r\n\r\n        <button\r\n          onClick={handleDownloadVisual}\r\n          className=\"flex items-center gap-2 px-4 py-2 bg-white dark:bg-[#252525] border border-gray-200 dark:border-[#444] rounded-lg text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-[#333] shadow-sm transition-colors text-xs font-medium\"\r\n        >\r\n          <Download size={14} />\r\n          Download PNG\r\n        </button>\r\n      </div>\r\n\r\n      <div className=\"flex-1 min-h-[300px] max-h-[600px] bg-white dark:bg-[#252525] p-8 border border-gray-200 dark:border-[#444] shadow-sm rounded-2xl relative\">\r\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n          {chartType === 'bar' ? (\r\n            <BarChart data={chartData} margin={{ top: 20, right: 30, left: 20, bottom: 20 }}>\r\n              <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"#F2F2F7\" />\r\n              <XAxis\r\n                dataKey={labelKey}\r\n                tick={{ fontSize: 11, fill: '#8E8E93' }}\r\n                axisLine={false}\r\n                tickLine={false}\r\n                dy={10}\r\n              />\r\n              <YAxis tick={{ fontSize: 11, fill: '#8E8E93' }} axisLine={false} tickLine={false} />\r\n              <Tooltip\r\n                cursor={{ fill: 'transparent' }}\r\n                contentStyle={{\r\n                  borderRadius: '12px',\r\n                  border: 'none',\r\n                  boxShadow: '0 4px 12px rgba(0,0,0,0.1)',\r\n                }}\r\n              />\r\n              <Legend wrapperStyle={{ paddingTop: '20px' }} />\r\n              {dataKeys.map((key, i) => (\r\n                <Bar\r\n                  key={key}\r\n                  dataKey={key}\r\n                  fill={colors[i % colors.length]}\r\n                  radius={[6, 6, 0, 0]}\r\n                  barSize={40}\r\n                >\r\n                  {showLabels && (\r\n                    <LabelList\r\n                      dataKey={key}\r\n                      position=\"top\"\r\n                      style={{ fontSize: '10px', fill: '#666' }}\r\n                    />\r\n                  )}\r\n                </Bar>\r\n              ))}\r\n            </BarChart>\r\n          ) : chartType === 'line' ? (\r\n            <LineChart data={chartData} margin={{ top: 20, right: 30, left: 20, bottom: 20 }}>\r\n              <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"#F2F2F7\" />\r\n              <XAxis\r\n                dataKey={labelKey}\r\n                tick={{ fontSize: 11, fill: '#8E8E93' }}\r\n                axisLine={false}\r\n                tickLine={false}\r\n                dy={10}\r\n              />\r\n              <YAxis tick={{ fontSize: 11, fill: '#8E8E93' }} axisLine={false} tickLine={false} />\r\n              <Tooltip\r\n                contentStyle={{\r\n                  borderRadius: '12px',\r\n                  border: 'none',\r\n                  boxShadow: '0 4px 12px rgba(0,0,0,0.1)',\r\n                }}\r\n              />\r\n              <Legend wrapperStyle={{ paddingTop: '20px' }} />\r\n              {dataKeys.map((key, i) => (\r\n                <Line\r\n                  key={key}\r\n                  type=\"monotone\"\r\n                  dataKey={key}\r\n                  stroke={colors[i % colors.length]}\r\n                  strokeWidth={3}\r\n                  dot={{ r: 4, strokeWidth: 0 }}\r\n                  activeDot={{ r: 6 }}\r\n                />\r\n              ))}\r\n            </LineChart>\r\n          ) : (\r\n            <RePieChart>\r\n              <Pie\r\n                data={chartData}\r\n                dataKey={dataKeys[0]}\r\n                nameKey={labelKey}\r\n                cx=\"50%\"\r\n                cy=\"50%\"\r\n                innerRadius={100}\r\n                outerRadius={140}\r\n                paddingAngle={4}\r\n                cornerRadius={6}\r\n              >\r\n                {chartData.map((entry, index) => (\r\n                  <Cell key={`cell-${index}`} fill={colors[index % colors.length]} strokeWidth={0} />\r\n                ))}\r\n              </Pie>\r\n              <Tooltip\r\n                contentStyle={{\r\n                  borderRadius: '12px',\r\n                  border: 'none',\r\n                  boxShadow: '0 4px 12px rgba(0,0,0,0.1)',\r\n                }}\r\n              />\r\n              <Legend />\r\n            </RePieChart>\r\n          )}\r\n        </ResponsiveContainer>\r\n      </div>\r\n    </div>\r\n  );\r\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1951, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/components/table/views/NotebookView.tsx"],"sourcesContent":["\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport { Sparkles, Printer, RefreshCw, Download, FileText, FileCode } from 'lucide-react';\r\nimport { GoogleGenAI } from '@google/genai';\r\nimport {\r\n  ResponsiveContainer, BarChart, Bar, LineChart, Line, AreaChart, Area,\r\n  PieChart as RePieChart, Pie, Cell, XAxis, YAxis, CartesianGrid, Tooltip, Legend\r\n} from 'recharts';\r\nimport { generatePivot } from '../../../utils/tableUtils';\r\nimport { downloadSvgAsPng } from '../../../utils/imageHelpers';\r\nimport { NotebookReport, NotebookBlock, COLOR_THEMES } from '../types';\r\n\r\ninterface NotebookViewProps {\r\n  headers: string[];\r\n  rows: any[];\r\n  fileName: string;\r\n  triggerOnMount?: boolean;\r\n  report: NotebookReport | null;\r\n  setReport: (report: NotebookReport | null) => void;\r\n}\r\n\r\n// Helper Component for Markdown\r\nconst NotebookMarkdown = ({ content }: { content: string }) => {\r\n  const lines = content.split('\\n');\r\n  const parseBold = (text: string) => {\r\n    const parts = text.split(/(\\*\\*.*?\\*\\*)/g);\r\n    return parts.map((part, index) => {\r\n      if (part.startsWith('**') && part.endsWith('**')) {\r\n        return <strong key={index} className=\"font-semibold text-gray-900 dark:text-white\">{part.slice(2, -2)}</strong>;\r\n      }\r\n      return part;\r\n    });\r\n  };\r\n\r\n  return (\r\n    <div className=\"space-y-2 text-sm\">\r\n      {lines.map((line, i) => {\r\n        const trimmed = line.trim();\r\n        if (trimmed === '---') return <hr key={i} className=\"my-6 border-gray-200 dark:border-[#333]\" />;\r\n        if (line.startsWith('# ')) return <h1 key={i} className=\"text-xl font-bold text-gray-900 dark:text-white mt-6 mb-3\">{line.replace('# ', '')}</h1>;\r\n        if (line.startsWith('## ')) return <h2 key={i} className=\"text-lg font-bold text-gray-900 dark:text-white mt-5 mb-2\">{line.replace('## ', '')}</h2>;\r\n        if (line.startsWith('### ')) return <h3 key={i} className=\"text-base font-bold text-gray-900 dark:text-white mt-4 mb-2\">{line.replace('### ', '')}</h3>;\r\n        if (line.startsWith('- ')) return <div key={i} className=\"flex gap-2 ml-2\"><span className=\"text-gray-400\">•</span><span className=\"text-gray-700 dark:text-gray-300\">{parseBold(line.replace('- ', ''))}</span></div>;\r\n        if (trimmed === '') return <div key={i} className=\"h-2\" />;\r\n        return <p key={i} className=\"text-gray-700 dark:text-gray-300 leading-relaxed\">{parseBold(line)}</p>;\r\n      })}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport const NotebookView: React.FC<NotebookViewProps> = ({ headers, rows, fileName, triggerOnMount, report, setReport }) => {\r\n  const [isAnalyzing, setIsAnalyzing] = useState(false);\r\n  const [isExporting, setIsExporting] = useState(false);\r\n  const themeColor = 'blue'; // Default theme\r\n\r\n  useEffect(() => {\r\n    if (triggerOnMount && !report && rows.length > 0) {\r\n      triggerAnalysis();\r\n    }\r\n  }, [triggerOnMount, rows]);\r\n\r\n  const triggerAnalysis = async () => {\r\n    if (rows.length === 0) return;\r\n    setIsAnalyzing(true);\r\n    try {\r\n      const ai = new GoogleGenAI({ apiKey: process.env.API_KEY });\r\n      \r\n      // Generate Data Profile\r\n      const profile: any = {};\r\n      headers.slice(0, 8).forEach((h) => { // Limit to first 8 cols to save tokens\r\n        const sampleVal = rows.find((r) => r[h] !== null && r[h] !== undefined)?.[h];\r\n        if (typeof sampleVal === 'number') {\r\n          const vals = rows.map((r) => Number(r[h])).filter((n) => !isNaN(n));\r\n          if (vals.length) {\r\n            const min = Math.min(...vals);\r\n            const max = Math.max(...vals);\r\n            const avg = vals.reduce((a, b) => a + b, 0) / vals.length;\r\n            profile[h] = { type: 'number', min, max, avg: avg.toFixed(2) };\r\n          }\r\n        } else {\r\n          const vals = rows.map((r) => String(r[h]));\r\n          const unique = new Set(vals).size;\r\n          const counts = vals.reduce((acc: any, v) => { acc[v] = (acc[v] || 0) + 1; return acc; }, {});\r\n          const top5 = Object.entries(counts).sort((a: any, b: any) => b[1] - a[1]).slice(0, 5);\r\n          profile[h] = { type: 'string', unique, top5 };\r\n        }\r\n      });\r\n\r\n      const prompt = `\r\n        You are an expert data analyst creating a comprehensive \"Data Notebook\" report.\r\n        DATA PROFILE: ${JSON.stringify(profile)}\r\n\r\n        TASK: Create a structured analysis notebook JSON with a title, summary, and a linear sequence of blocks.\r\n        The analysis MUST follow this strict chapter structure:\r\n        1. Dataset Overview (Row counts, structure, quality)\r\n        2. Distributions (Histograms/Bars of key numeric fields)\r\n        3. Categorical Breakdown (Pie/Bar charts of categories)\r\n        4. Time-Series Trends (Lines/Areas if dates exist, else skip)\r\n        5. Correlation Analysis (Scatter descriptions or Bar charts of relationships)\r\n        6. Marketing Metrics (If applicable: conversion, cost, sales, ROI)\r\n        7. Anomaly Detection (Highlight outliers or weird patterns)\r\n        8. Final Recommendations (Actionable bullet points)\r\n\r\n        RULES:\r\n        - Never place two \"chart\" blocks back-to-back. Always separate them with a \"text\" block providing narrative/context.\r\n        - \"text\" blocks should use Markdown (use # for Chapter Titles, ## for sections, **bold** for emphasis).\r\n        - \"chart\" blocks must have valid 'xAxis' and 'yAxis' from the data headers provided in the profile.\r\n        - If a chapter is not applicable (e.g. no dates for time-series), skip it gracefully.\r\n\r\n        Response JSON format:\r\n        {\r\n          \"title\": string,\r\n          \"summary\": string,\r\n          \"blocks\": [\r\n            { \"type\": \"text\", \"content\": string },\r\n            { \"type\": \"stat\", \"statLabel\": string, \"statValue\": string, \"trend\": \"up\"|\"down\"|\"neutral\" },\r\n            { \"type\": \"chart\", \"title\": string, \"chartType\": \"bar\"|\"line\"|\"pie\"|\"area\", \"xAxis\": string, \"yAxis\": string, \"aggregation\": \"sum\"|\"count\"|\"average\", \"explanation\": string }\r\n          ]\r\n        }\r\n      `;\r\n\r\n      const response = await ai.models.generateContent({\r\n        model: 'gemini-2.5-flash',\r\n        contents: prompt,\r\n        config: { responseMimeType: 'application/json' }\r\n      });\r\n\r\n      const json = JSON.parse(response.text || '{}');\r\n      if (json.title && json.blocks) {\r\n        setReport(json);\r\n      }\r\n    } catch (e) {\r\n      console.error(\"Analysis failed\", e);\r\n    } finally {\r\n      setIsAnalyzing(false);\r\n    }\r\n  };\r\n\r\n  const aggregateForChart = (xAxis: string, yAxis: string, aggType: 'sum' | 'count' | 'average' = 'sum') => {\r\n    const result = generatePivot(rows, {\r\n      rows: [xAxis],\r\n      columns: [],\r\n      values: [yAxis],\r\n      aggregation: aggType,\r\n    });\r\n    return result ? result.data : [];\r\n  };\r\n\r\n  const handleDownloadChartPng = (index: number, title: string) => {\r\n    const container = document.getElementById(`chart-block-${index}`);\r\n    // Use robust selector to target Recharts wrapper SVG only, ignoring button icons\r\n    const svg = container?.querySelector('.recharts-wrapper svg');\r\n    if (svg) {\r\n      downloadSvgAsPng(svg as SVGElement, `${title.replace(/\\s+/g, '_')}.png`);\r\n    } else {\r\n      console.error(\"Could not find chart SVG in block\", index);\r\n    }\r\n  };\r\n\r\n  const getChartBase64 = async (index: number): Promise<string | null> => {\r\n    const container = document.getElementById(`chart-block-${index}`);\r\n    // Use robust selector here as well\r\n    const svg = container?.querySelector('.recharts-wrapper svg');\r\n    if (!svg) return null;\r\n\r\n    const serializer = new XMLSerializer();\r\n    const svgString = serializer.serializeToString(svg);\r\n    \r\n    return new Promise((resolve) => {\r\n        const img = new Image();\r\n        // Encode the SVG string to be safe for data URI\r\n        const svgBlob = new Blob([svgString], {type: 'image/svg+xml;charset=utf-8'});\r\n        const url = URL.createObjectURL(svgBlob);\r\n        \r\n        img.onload = () => {\r\n            const canvas = document.createElement('canvas');\r\n            // Use bounding rect to determine size, multiplying by 2 for high DPI\r\n            const rect = svg.getBoundingClientRect();\r\n            const width = rect.width > 0 ? rect.width * 2 : 800;\r\n            const height = rect.height > 0 ? rect.height * 2 : 600;\r\n\r\n            canvas.width = width;\r\n            canvas.height = height;\r\n            \r\n            const ctx = canvas.getContext('2d');\r\n            if (ctx) {\r\n                ctx.fillStyle = '#ffffff';\r\n                ctx.fillRect(0, 0, canvas.width, canvas.height);\r\n                ctx.drawImage(img, 0, 0, canvas.width, canvas.height);\r\n                resolve(canvas.toDataURL('image/png'));\r\n            } else {\r\n                resolve(null);\r\n            }\r\n            URL.revokeObjectURL(url);\r\n        };\r\n        img.onerror = () => {\r\n            console.error(\"Failed to load SVG image for export\");\r\n            URL.revokeObjectURL(url);\r\n            resolve(null);\r\n        }\r\n        img.src = url;\r\n    });\r\n  };\r\n\r\n  const handleExport = async (format: 'html' | 'md') => {\r\n    if (!report) return;\r\n    setIsExporting(true);\r\n\r\n    try {\r\n        let content = '';\r\n        const timestamp = new Date().toLocaleDateString();\r\n\r\n        if (format === 'html') {\r\n            content = `\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n    <title>${report.title}</title>\r\n    <style>\r\n        body { font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif; line-height: 1.6; max-w-width: 900px; margin: 0 auto; padding: 40px; color: #333; }\r\n        h1 { font-size: 2.5em; margin-bottom: 10px; color: #111; }\r\n        h2 { margin-top: 40px; border-bottom: 1px solid #eee; padding-bottom: 10px; color: #222; }\r\n        h3 { margin-top: 25px; color: #444; }\r\n        p { margin-bottom: 15px; color: #555; }\r\n        .stat-grid { display: flex; gap: 20px; margin: 30px 0; flex-wrap: wrap; }\r\n        .stat-card { background: #f9f9f9; padding: 20px; border-radius: 12px; border: 1px solid #eee; min-width: 150px; }\r\n        .stat-label { font-size: 12px; text-transform: uppercase; color: #777; font-weight: 600; letter-spacing: 0.5px; }\r\n        .stat-value { font-size: 24px; font-weight: 700; color: #111; margin-top: 5px; }\r\n        .chart-container { margin: 40px 0; padding: 30px; border: 1px solid #eee; border-radius: 12px; background: #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }\r\n        .chart-img { width: 100%; height: auto; display: block; border-radius: 4px; }\r\n        .summary { background: #f0f9ff; padding: 25px; border-radius: 12px; color: #0c4a6e; margin-bottom: 40px; line-height: 1.8; }\r\n        .explanation { font-style: italic; color: #666; margin-bottom: 15px; display: block; }\r\n    </style>\r\n</head>\r\n<body>\r\n    <h1>${report.title}</h1>\r\n    <p style=\"color: #666; font-size: 0.9em;\">Generated on ${timestamp}</p>\r\n    \r\n    <div class=\"summary\">\r\n        <strong>Executive Summary</strong><br/>\r\n        ${report.summary}\r\n    </div>\r\n            `;\r\n        } else {\r\n            content = `# ${report.title}\\n\\nGenerated on: ${timestamp}\\n\\n**Executive Summary**\\n\\n${report.summary}\\n\\n---\\n\\n`;\r\n        }\r\n\r\n        // Iterate blocks\r\n        for (let i = 0; i < report.blocks.length; i++) {\r\n            const block = report.blocks[i];\r\n            \r\n            if (block.type === 'text') {\r\n                const text = block.content || '';\r\n                if (format === 'html') {\r\n                    // Simple markdown-ish parser for HTML export\r\n                    let htmlText = text\r\n                        .replace(/^# (.*$)/gm, '<h1>$1</h1>')\r\n                        .replace(/^## (.*$)/gm, '<h2>$1</h2>')\r\n                        .replace(/^### (.*$)/gm, '<h3>$1</h3>')\r\n                        .replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>')\r\n                        .replace(/\\n/g, '<br/>');\r\n                    content += `<div class=\"text-block\">${htmlText}</div>`;\r\n                } else {\r\n                    content += `${text}\\n\\n`;\r\n                }\r\n            } \r\n            else if (block.type === 'stat') {\r\n                if (format === 'html') {\r\n                    content += `\r\n                    <div class=\"stat-grid\">\r\n                        <div class=\"stat-card\">\r\n                            <div class=\"stat-label\">${block.statLabel}</div>\r\n                            <div class=\"stat-value\">${block.statValue}</div>\r\n                        </div>\r\n                    </div>`;\r\n                } else {\r\n                    content += `**${block.statLabel}**: ${block.statValue}\\n\\n`;\r\n                }\r\n            }\r\n            else if (block.type === 'chart') {\r\n                // Capture chart\r\n                const base64 = await getChartBase64(i);\r\n                if (base64) {\r\n                    if (format === 'html') {\r\n                        content += `\r\n                        <div class=\"chart-container\">\r\n                            <h3>${block.title}</h3>\r\n                            <span class=\"explanation\">${block.explanation}</span>\r\n                            <img src=\"${base64}\" class=\"chart-img\" alt=\"${block.title}\" />\r\n                        </div>`;\r\n                    } else {\r\n                        content += `### ${block.title}\\n\\n*${block.explanation}*\\n\\n![${block.title}](${base64})\\n\\n`;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (format === 'html') {\r\n            content += `</body></html>`;\r\n            const blob = new Blob([content], { type: 'text/html' });\r\n            const url = URL.createObjectURL(blob);\r\n            const a = document.createElement('a');\r\n            a.href = url;\r\n            a.download = `${fileName}_notebook.html`;\r\n            a.click();\r\n        } else {\r\n            const blob = new Blob([content], { type: 'text/markdown' });\r\n            const url = URL.createObjectURL(blob);\r\n            const a = document.createElement('a');\r\n            a.href = url;\r\n            a.download = `${fileName}_notebook.md`;\r\n            a.click();\r\n        }\r\n\r\n    } catch (e) {\r\n        console.error(\"Export failed\", e);\r\n    } finally {\r\n        setIsExporting(false);\r\n    }\r\n  };\r\n\r\n  const renderBlock = (block: NotebookBlock, index: number) => {\r\n    if (block.type === 'text') {\r\n      return <div key={index} className=\"mb-6\"><NotebookMarkdown content={block.content || ''} /></div>;\r\n    }\r\n    if (block.type === 'chart') {\r\n      const chartData = block.xAxis && block.yAxis ? aggregateForChart(block.xAxis, block.yAxis, block.aggregation) : [];\r\n      if (!chartData.length) return null;\r\n      const colors = COLOR_THEMES[themeColor];\r\n      const ChartComponent = block.chartType === 'line' ? LineChart : block.chartType === 'pie' ? RePieChart : block.chartType === 'area' ? AreaChart : BarChart;\r\n\r\n      return (\r\n        <div key={index} id={`chart-block-${index}`} className=\"mb-8 bg-white dark:bg-[#252525] p-6 rounded-2xl border border-gray-100 dark:border-[#333] shadow-sm break-inside-avoid\">\r\n          <div className=\"flex justify-between items-start mb-4\">\r\n            <div>\r\n              <h4 className=\"font-semibold text-gray-900 dark:text-white text-lg\">{block.title}</h4>\r\n              {block.explanation && <p className=\"text-sm text-gray-500 dark:text-gray-400 mt-1 max-w-xl\">{block.explanation}</p>}\r\n            </div>\r\n            <button onClick={() => handleDownloadChartPng(index, block.title || 'chart')} className=\"text-xs font-medium text-blue-600 flex items-center gap-1 bg-blue-50 px-2 py-1 rounded hover:bg-blue-100 transition-colors\">\r\n              <Download size={12} /> PNG\r\n            </button>\r\n          </div>\r\n          <div className=\"h-[250px] md:h-[300px] w-full\">\r\n            <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n               {block.chartType === 'pie' ? (\r\n                 <RePieChart>\r\n                    <Pie data={chartData} dataKey=\"Total\" nameKey=\"name\" cx=\"50%\" cy=\"50%\" innerRadius={60} outerRadius={100} paddingAngle={4}>\r\n                        {chartData.map((_, idx) => <Cell key={`cell-${idx}`} fill={colors[idx % colors.length]} strokeWidth={0} />)}\r\n                    </Pie>\r\n                    <Tooltip />\r\n                    <Legend />\r\n                 </RePieChart>\r\n               ) : (\r\n                 <ChartComponent data={chartData} margin={{ top: 10, right: 10, left: 0, bottom: 0 }}>\r\n                    <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"#eee\" />\r\n                    <XAxis dataKey=\"name\" tick={{ fontSize: 11 }} axisLine={false} tickLine={false} />\r\n                    <YAxis tick={{ fontSize: 11 }} axisLine={false} tickLine={false} />\r\n                    <Tooltip />\r\n                    {block.chartType === 'line' ? (\r\n                         <Line type=\"monotone\" dataKey=\"Total\" stroke={colors[0]} strokeWidth={3} dot={{r:4}} />\r\n                    ) : block.chartType === 'area' ? (\r\n                         <Area type=\"monotone\" dataKey=\"Total\" stroke={colors[0]} fill={colors[0]} fillOpacity={0.3} />\r\n                    ) : (\r\n                         <Bar dataKey=\"Total\" fill={colors[0]} radius={[4, 4, 0, 0]} />\r\n                    )}\r\n                 </ChartComponent>\r\n               )}\r\n            </ResponsiveContainer>\r\n          </div>\r\n        </div>\r\n      );\r\n    }\r\n    return null;\r\n  };\r\n\r\n  return (\r\n    <div className=\"flex h-full bg-[#F5F5F7] dark:bg-[#1e1e1e]\">\r\n      <div className=\"flex-1 p-4 md:p-8 overflow-y-auto\">\r\n        <div className=\"max-w-3xl mx-auto\">\r\n          {isAnalyzing ? (\r\n            <div className=\"flex flex-col items-center justify-center py-20 gap-6\">\r\n              <div className=\"w-10 h-10 border-4 border-gray-200 border-t-blue-500 rounded-full animate-spin\"></div>\r\n              <p className=\"text-sm text-gray-500 font-medium animate-pulse\">Analyzing data & generating chapters...</p>\r\n            </div>\r\n          ) : report ? (\r\n            <div className=\"animate-in fade-in duration-500 pb-20\">\r\n              <div className=\"mb-8 pb-6 border-b border-gray-200 dark:border-[#333]\">\r\n                <div className=\"flex items-center justify-between mb-3\">\r\n                   <div className=\"flex items-center gap-2 text-xs font-bold text-blue-600 uppercase\"><Sparkles size={12} /><span>AI Analysis</span></div>\r\n                   <div className=\"flex gap-2\">\r\n                      <button \r\n                        onClick={() => handleExport('html')} \r\n                        disabled={isExporting}\r\n                        className=\"flex items-center gap-2 text-xs font-medium bg-white dark:bg-[#333] dark:text-white px-3 py-1.5 rounded-full border dark:border-[#444] shadow-sm hover:bg-gray-50 dark:hover:bg-[#404040] transition-colors disabled:opacity-50\"\r\n                      >\r\n                        {isExporting ? <RefreshCw size={12} className=\"animate-spin\" /> : <FileCode size={12} />}\r\n                        HTML\r\n                      </button>\r\n                      <button \r\n                        onClick={() => handleExport('md')} \r\n                        disabled={isExporting}\r\n                        className=\"flex items-center gap-2 text-xs font-medium bg-white dark:bg-[#333] dark:text-white px-3 py-1.5 rounded-full border dark:border-[#444] shadow-sm hover:bg-gray-50 dark:hover:bg-[#404040] transition-colors disabled:opacity-50\"\r\n                      >\r\n                        {isExporting ? <RefreshCw size={12} className=\"animate-spin\" /> : <FileText size={12} />}\r\n                        Markdown\r\n                      </button>\r\n                   </div>\r\n                </div>\r\n                <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white mb-3\">{report.title}</h1>\r\n                <p className=\"text-lg text-gray-500\">{report.summary}</p>\r\n              </div>\r\n              <div className=\"flex flex-wrap gap-4 mb-8\">\r\n                  {report.blocks.filter(b => b.type === 'stat').map((b, i) => (\r\n                      <div key={i} className=\"p-5 bg-white dark:bg-[#2a2a2a] rounded-2xl border border-gray-100 dark:border-[#333] min-w-[160px] shadow-sm flex-1 md:flex-none\">\r\n                          <span className=\"text-xs text-gray-500 uppercase font-semibold tracking-wider\">{b.statLabel}</span>\r\n                          <div className=\"flex items-end gap-2 mt-2\">\r\n                              <span className=\"text-3xl font-bold text-gray-900 dark:text-white\">{b.statValue}</span>\r\n                              {b.trend && (\r\n                                <span className={`text-xs font-medium px-1.5 py-0.5 rounded ${\r\n                                    b.trend === 'up' ? 'bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-400' : \r\n                                    b.trend === 'down' ? 'bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-400' : \r\n                                    'bg-gray-100 text-gray-600 dark:bg-gray-800 dark:text-gray-400'\r\n                                }`}>\r\n                                    {b.trend === 'up' ? '↑' : b.trend === 'down' ? '↓' : '−'}\r\n                                </span>\r\n                              )}\r\n                          </div>\r\n                      </div>\r\n                  ))}\r\n              </div>\r\n              <div className=\"space-y-2\">\r\n                   {report.blocks.filter(b => b.type !== 'stat').map((b, i) => renderBlock(b, i))}\r\n              </div>\r\n              <div className=\"mt-12 pt-6 border-t border-gray-200 dark:border-[#333] flex justify-between\">\r\n                 <span className=\"text-gray-400 text-xs font-medium\">Generated for {fileName}</span>\r\n                 <button onClick={triggerAnalysis} className=\"flex items-center gap-2 text-xs font-medium text-blue-600 dark:text-blue-400 hover:underline\"><RefreshCw size={12} /> Regenerate Analysis</button>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <div className=\"h-[400px] flex flex-col items-center justify-center text-center p-8\">\r\n                <div className=\"w-16 h-16 bg-white dark:bg-[#333] rounded-full flex items-center justify-center mb-4 text-blue-500 shadow-sm border border-gray-100 dark:border-[#333]\"><Sparkles size={24} /></div>\r\n                <h3 className=\"text-xl font-semibold mb-2 text-gray-900 dark:text-white\">AI Data Notebook</h3>\r\n                <p className=\"text-gray-500 dark:text-gray-400 mb-6 max-w-md\">Generate a comprehensive report with specific chapters: Overview, Distributions, Trends, Correlations, and Recommendations.</p>\r\n                <button onClick={triggerAnalysis} className=\"px-6 py-2.5 bg-blue-600 hover:bg-blue-700 text-white text-sm font-medium rounded-full shadow-lg hover:scale-105 transition-all\">Generate Report</button>\r\n            </div>\r\n          )}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 2914, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/components/table/TableDrawer.tsx"],"sourcesContent":["\r\nimport React, { useState, useEffect, useMemo, useCallback, useRef } from 'react';\r\nimport { TableData } from '../../types/chat';\r\nimport { Grid, Settings2, PieChart, Sparkles, Table as TableIcon, X, Check } from 'lucide-react';\r\nimport { DataGridView } from './views/DataGridView';\r\nimport { PivotView } from './views/PivotView';\r\nimport { VisualsView } from './views/VisualsView';\r\nimport { NotebookView } from './views/NotebookView';\r\nimport { PivotConfig } from '../../utils/tableUtils';\r\nimport { NotebookReport } from '../types';\r\n\r\ninterface TableDrawerProps {\r\n  isOpen: boolean;\r\n  data: TableData | null;\r\n  fileName: string;\r\n  visualHint?: string;\r\n  onClose: () => void;\r\n  onSave: (newData: TableData) => void;\r\n  mode?: 'fixed' | 'inline';\r\n}\r\n\r\nexport const TableDrawer: React.FC<TableDrawerProps> = ({\r\n  isOpen,\r\n  data,\r\n  fileName,\r\n  visualHint,\r\n  onClose,\r\n  onSave,\r\n  mode = 'fixed',\r\n}) => {\r\n  const [activeTab, setActiveTab] = useState<'data' | 'pivot' | 'visuals' | 'analysis'>('data');\r\n  const [lastSaved, setLastSaved] = useState<Date | null>(null);\r\n  const [isSyncing, setIsSyncing] = useState(false);\r\n  \r\n  // Data State\r\n  const [rows, setRows] = useState<any[]>([]);\r\n  const [headers, setHeaders] = useState<string[]>([]);\r\n  \r\n  // View States\r\n  const [filters, setFilters] = useState<Record<string, string>>({});\r\n  const [sortConfig, setSortConfig] = useState<{ key: string; dir: 'asc' | 'desc' } | null>(null);\r\n  const [pivotConfig, setPivotConfig] = useState<PivotConfig>({\r\n    rows: [], columns: [], values: [], aggregation: 'sum'\r\n  });\r\n  const [visualsConfig, setVisualsConfig] = useState<{ chartType: 'bar' | 'pie' | 'line', themeColor: string }>({\r\n    chartType: 'bar', themeColor: 'blue'\r\n  });\r\n  const [notebookReport, setNotebookReport] = useState<NotebookReport | null>(null);\r\n\r\n  const saveTimerRef = useRef<any>(null);\r\n  const lastUpdateRef = useRef<string>('');\r\n\r\n  // Initialize once or when forced externally\r\n  useEffect(() => {\r\n    if (data) {\r\n      const dataHash = JSON.stringify({ h: data.headers, rCount: data.rows.length });\r\n      // Only reset if it's a completely different dataset, not a silent autosave update from parent\r\n      if (lastUpdateRef.current !== dataHash) {\r\n        setRows(data.rows);\r\n        setHeaders(data.headers);\r\n        lastUpdateRef.current = dataHash;\r\n      }\r\n\r\n      if (data.metadata) {\r\n         if (data.metadata.filters) setFilters(data.metadata.filters);\r\n         if (data.metadata.sortConfig) setSortConfig(data.metadata.sortConfig);\r\n         if (data.metadata.pivotConfig) setPivotConfig(data.metadata.pivotConfig);\r\n         if (data.metadata.visualsConfig) setVisualsConfig(data.metadata.visualsConfig);\r\n         if (data.metadata.notebookReport) setNotebookReport(data.metadata.notebookReport);\r\n      }\r\n      if (visualHint && ['bar', 'pie', 'line'].includes(visualHint)) {\r\n          setActiveTab('visuals');\r\n          setVisualsConfig(prev => ({ ...prev, chartType: visualHint as any }));\r\n      }\r\n    }\r\n  }, [data, visualHint]);\r\n\r\n  // Persist logic - Silent background save\r\n  const persistState = useCallback(() => {\r\n      const metadata = {\r\n          pivotConfig,\r\n          visualsConfig,\r\n          notebookReport,\r\n          filters,\r\n          sortConfig\r\n      };\r\n      onSave({ headers, rows, metadata });\r\n      setLastSaved(new Date());\r\n  }, [headers, rows, pivotConfig, visualsConfig, notebookReport, filters, sortConfig, onSave]);\r\n\r\n  // 3-second Autosave Effect - Truly in the background\r\n  useEffect(() => {\r\n    if (!isOpen) return;\r\n    if (saveTimerRef.current) clearTimeout(saveTimerRef.current);\r\n    \r\n    saveTimerRef.current = setTimeout(() => {\r\n        persistState();\r\n    }, 3000);\r\n\r\n    return () => {\r\n        if (saveTimerRef.current) clearTimeout(saveTimerRef.current);\r\n    };\r\n  }, [rows, pivotConfig, visualsConfig, filters, sortConfig, isOpen, persistState]);\r\n\r\n  const handleRowUpdate = useCallback((id: string, updates: Record<string, any>) => {\r\n    setRows(prev => prev.map(r => r.id === id ? { ...r, ...updates } : r));\r\n  }, []);\r\n\r\n  const handleAddRow = useCallback(() => {\r\n    const newRow: any = { id: `row-${Date.now()}` };\r\n    headers.forEach(h => newRow[h] = '');\r\n    setRows(prev => [...prev, newRow]);\r\n  }, [headers]);\r\n\r\n  const handleDeleteRow = useCallback((id: string) => {\r\n    setRows(prev => prev.filter(r => r.id !== id));\r\n  }, []);\r\n\r\n  const processedRows = useMemo(() => {\r\n    let res = [...rows];\r\n    Object.keys(filters).forEach((key) => {\r\n      const val = filters[key].toLowerCase();\r\n      if (val) res = res.filter((r) => r[key]?.toString().toLowerCase().includes(val));\r\n    });\r\n    if (sortConfig) {\r\n      res.sort((a, b) => {\r\n        const av = a[sortConfig.key];\r\n        const bv = b[sortConfig.key];\r\n        if (av < bv) return sortConfig.dir === 'asc' ? -1 : 1;\r\n        if (av > bv) return sortConfig.dir === 'asc' ? 1 : -1;\r\n        return 0;\r\n      });\r\n    }\r\n    return res;\r\n  }, [rows, filters, sortConfig]);\r\n\r\n  const containerClasses = mode === 'inline'\r\n    ? 'w-full h-full flex flex-col bg-white dark:bg-[#1e1e1e] overflow-hidden'\r\n    : `fixed inset-y-0 right-0 z-[60] w-[95vw] md:w-[90vw] lg:w-[1200px] bg-white dark:bg-[#1e1e1e] shadow-2xl transform transition-transform duration-300 ease-in-out border-l border-gray-200 dark:border-[#333] flex flex-col ${isOpen ? 'translate-x-0' : 'translate-x-full'}`;\r\n\r\n  if (mode === 'inline' && !isOpen) return null;\r\n\r\n  return (\r\n    <div className={containerClasses}>\r\n      <div className=\"h-14 flex items-center justify-between px-6 flex-shrink-0 bg-white/80 dark:bg-[#1e1e1e]/80 backdrop-blur-md border-b border-gray-200 dark:border-[#333] z-10\">\r\n        <div className=\"flex items-center gap-4\">\r\n          <div className=\"flex items-center justify-center w-8 h-8 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-blue-600 dark:text-blue-400 shadow-sm\">\r\n            <TableIcon size={18} />\r\n          </div>\r\n          <div className=\"flex flex-col\">\r\n            <h2 className=\"text-sm font-medium text-gray-900 dark:text-white tracking-tight\">{fileName}</h2>\r\n            <div className=\"flex items-center gap-1.5\">\r\n                <span className=\"text-[9px] font-medium uppercase tracking-widest text-gray-400\">\r\n                    {lastSaved ? `Autosaved ${lastSaved.toLocaleTimeString([], {hour:'2-digit', minute:'2-digit'})}` : 'Live Workspace'}\r\n                </span>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div className=\"hidden md:flex bg-gray-100 dark:bg-[#2a2a2a] p-1 rounded-xl\">\r\n          {[\r\n            { id: 'data', label: 'Grid', icon: Grid },\r\n            { id: 'pivot', label: 'Pivot', icon: Settings2 },\r\n            { id: 'visuals', label: 'Chart', icon: PieChart },\r\n            { id: 'analysis', label: 'Notebook', icon: Sparkles },\r\n          ].map((tab) => (\r\n            <button\r\n              key={tab.id}\r\n              onClick={() => setActiveTab(tab.id as any)}\r\n              className={`flex items-center gap-2 px-4 py-1.5 text-[11px] font-medium uppercase tracking-wider rounded-lg transition-all duration-300 ${\r\n                activeTab === tab.id\r\n                  ? 'bg-white dark:bg-[#333] text-gray-900 dark:text-white shadow-sm'\r\n                  : 'text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200'\r\n              }`}\r\n            >\r\n              <tab.icon size={13} strokeWidth={2} />\r\n              {tab.label}\r\n            </button>\r\n          ))}\r\n        </div>\r\n\r\n        <div className=\"flex items-center gap-2\">\r\n          <button\r\n            onClick={persistState}\r\n            className=\"flex items-center gap-2 px-5 py-1.5 bg-black dark:bg-white text-white dark:text-black text-xs font-medium rounded-full hover:opacity-80 transition-all active:scale-95 shadow-sm\"\r\n          >\r\n            Save\r\n          </button>\r\n          <button\r\n            onClick={onClose}\r\n            className=\"p-2 text-gray-400 hover:text-black dark:hover:text-white hover:bg-gray-100 dark:hover:bg-[#333] rounded-full transition-all\"\r\n          >\r\n            <X size={18} strokeWidth={2} />\r\n          </button>\r\n        </div>\r\n      </div>\r\n\r\n      <div className=\"flex-1 overflow-hidden relative bg-[#F5F5F7] dark:bg-[#1e1e1e]\">\r\n        {activeTab === 'data' && (\r\n          <DataGridView\r\n            headers={headers}\r\n            rows={processedRows}\r\n            onRowUpdate={handleRowUpdate}\r\n            onAddRow={handleAddRow}\r\n            onDeleteRow={handleDeleteRow}\r\n            filters={filters}\r\n            setFilters={setFilters}\r\n            sortConfig={sortConfig}\r\n            setSortConfig={setSortConfig}\r\n          />\r\n        )}\r\n        {activeTab === 'pivot' && (\r\n           <PivotView \r\n              headers={headers} \r\n              rows={processedRows} \r\n              config={pivotConfig}\r\n              setConfig={setPivotConfig}\r\n           />\r\n        )}\r\n        {activeTab === 'visuals' && (\r\n          <VisualsView\r\n            headers={headers}\r\n            rows={processedRows}\r\n            fileName={fileName}\r\n            config={visualsConfig}\r\n            setConfig={setVisualsConfig}\r\n          />\r\n        )}\r\n        {activeTab === 'analysis' && (\r\n          <NotebookView\r\n            headers={headers}\r\n            rows={processedRows}\r\n            fileName={fileName}\r\n            report={notebookReport}\r\n            setReport={setNotebookReport}\r\n            triggerOnMount={!notebookReport}\r\n          />\r\n        )}\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 3306, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/app/datasets/page.tsx"],"sourcesContent":["'use client';\r\n\r\nimport React, { useState, useEffect, useRef } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport { EmbeddedTable } from '../../components/chat/EmbeddedTable';\r\nimport { TableDrawer } from '../../components/table/TableDrawer';\r\nimport { TableData } from '../../types/chat';\r\nimport { useApp } from '../../context/AppContext';\r\nimport { Filter, Plus, CheckCircle2, Search, BookOpen, MessageSquare, Check, Copy, Archive, Trash2 } from 'lucide-react';\r\n\r\n// Mock Data Generation\r\nconst MOCK_DATASETS = [\r\n    {\r\n        id: '1',\r\n        name: 'Retail Sales Forecast Demo',\r\n        source: 'Salesforce',\r\n        type: 'CSV',\r\n        updated: 'Last Monday at 12:33 AM',\r\n        status: 'Not deployed',\r\n        data: {\r\n            headers: ['Store ID', 'Employee ID', 'Area', 'Date'],\r\n            rows: [\r\n                { 'Store ID': 1, 'Employee ID': 54, 'Area': 'Asia', 'Date': '2018-01-31' },\r\n                { 'Store ID': 1, 'Employee ID': 57, 'Area': 'Asia', 'Date': '2018-02-28' },\r\n                { 'Store ID': 1, 'Employee ID': 50, 'Area': 'Asia', 'Date': '2018-03-31' },\r\n                { 'Store ID': 1, 'Employee ID': 56, 'Area': 'Asia', 'Date': '2018-04-30' },\r\n            ]\r\n        }\r\n    },\r\n    {\r\n        id: '2',\r\n        name: 'Employee Attrition Demo',\r\n        source: 'Workday',\r\n        type: 'XLSX',\r\n        updated: '06/27/2025',\r\n        status: 'Not deployed',\r\n        visualHint: 'bar',\r\n        data: {\r\n            headers: ['Job Title', 'Years of Exp', 'Department', 'Salary Range'],\r\n            rows: [\r\n                { 'Job Title': 'Assistant', 'Years of Exp': 25, 'Department': 'Sales', 'Salary Range': 'High' },\r\n                { 'Job Title': 'Consultant', 'Years of Exp': 29, 'Department': 'Customer Service', 'Salary Range': 'Medium' },\r\n                { 'Job Title': 'Executive', 'Years of Exp': 6, 'Department': 'Sales', 'Salary Range': 'High' },\r\n                { 'Job Title': 'Consultant', 'Years of Exp': 3, 'Department': 'Marketing', 'Salary Range': 'Medium' },\r\n            ]\r\n        }\r\n    },\r\n    {\r\n        id: '3',\r\n        name: 'inconsistent_dataset',\r\n        source: 'Manual Upload',\r\n        type: 'JSON',\r\n        updated: '12/04/2024',\r\n        status: 'Not deployed',\r\n        data: {\r\n            headers: ['Product_ID', 'Price', 'Advertising', 'Budget'],\r\n            rows: [\r\n                { 'Product_ID': 'P001', 'Price': null, 'Advertising': null, 'Budget': null },\r\n                { 'Product_ID': 'P002', 'Price': 150, 'Advertising': 510.0, 'Budget': 11500.0 },\r\n                { 'Product_ID': 'P003', 'Price': 200, 'Advertising': 520.0, 'Budget': 12000.0 },\r\n                { 'Product_ID': 'P004', 'Price': 250, 'Advertising': 530.0, 'Budget': 12500.0 },\r\n            ]\r\n        }\r\n    },\r\n    {\r\n        id: '4',\r\n        name: 'Sentiment Model',\r\n        source: 'HuggingFace',\r\n        type: 'Parquet',\r\n        updated: '12/02/2024',\r\n        status: 'Deployed',\r\n        visualHint: 'pie',\r\n        data: {\r\n            headers: ['Review Text', 'Review', 'Review_Binary'],\r\n            rows: [\r\n                { 'Review Text': 'Wow... Loved this place.', 'Review': 'Positive', 'Review_Binary': 1 },\r\n                { 'Review Text': 'Crust is not good.', 'Review': 'Negative', 'Review_Binary': 0 },\r\n                { 'Review Text': 'Not tasty and texture bad.', 'Review': 'Negative', 'Review_Binary': 0 },\r\n                { 'Review Text': 'Stopped by during late May...', 'Review': 'Positive', 'Review_Binary': 1 },\r\n            ]\r\n        }\r\n    },\r\n    {\r\n        id: '5',\r\n        name: 'Lead Scoring Demo',\r\n        source: 'HubSpot',\r\n        type: 'CSV',\r\n        updated: '11/27/2024',\r\n        status: 'Not deployed',\r\n        data: {\r\n            headers: ['Job Title', 'Years of Exp', 'Company Size', 'Industry'],\r\n            rows: [\r\n                { 'Job Title': 'Assistant', 'Years of Exp': 23, 'Company Size': 'Large', 'Industry': 'IT' },\r\n                { 'Job Title': 'Manager', 'Years of Exp': 23, 'Company Size': 'Large', 'Industry': 'Finance' },\r\n                { 'Job Title': 'Manager', 'Years of Exp': 24, 'Company Size': 'Large', 'Industry': 'Finance' },\r\n                { 'Job Title': 'Executive', 'Years of Exp': 3, 'Company Size': 'Large', 'Industry': 'Healthcare' },\r\n            ]\r\n        }\r\n    },\r\n    {\r\n        id: '6',\r\n        name: 'Churn Prediction Demo',\r\n        source: 'Salesforce',\r\n        type: 'CSV',\r\n        updated: '11/27/2024',\r\n        status: 'Not deployed',\r\n        data: {\r\n            headers: ['Customer_ID', 'Tenure', 'MonthlyCharges', 'TotalCharges'],\r\n            rows: [\r\n                { 'Customer_ID': 'C1001', 'Tenure': 12, 'MonthlyCharges': 70.5, 'TotalCharges': 846.0 },\r\n                { 'Customer_ID': 'C1002', 'Tenure': 24, 'MonthlyCharges': 85.0, 'TotalCharges': 2040.0 },\r\n                { 'Customer_ID': 'C1003', 'Tenure': 5, 'MonthlyCharges': 50.0, 'TotalCharges': 250.0 },\r\n                { 'Customer_ID': 'C1004', 'Tenure': 36, 'MonthlyCharges': 90.0, 'TotalCharges': 3240.0 },\r\n            ]\r\n        }\r\n    },\r\n    {\r\n        id: '7',\r\n        name: 'Credit Card Fraud Demo',\r\n        source: 'Stripe',\r\n        type: 'JSON',\r\n        updated: '11/27/2024',\r\n        status: 'Not deployed',\r\n        data: {\r\n            headers: ['Transaction_ID', 'Transaction_Type', 'Currency', 'Amount'],\r\n            rows: [\r\n                { 'Transaction_ID': 7271, 'Transaction_Type': 'US', 'Currency': 'AUD', 'Amount': 1 },\r\n                { 'Transaction_ID': 861, 'Transaction_Type': 'US', 'Currency': 'AUD', 'Amount': 8 },\r\n                { 'Transaction_ID': 5391, 'Transaction_Type': 'US', 'Currency': 'CAD', 'Amount': 12 },\r\n                { 'Transaction_ID': 5192, 'Transaction_Type': 'US', 'Currency': 'USD', 'Amount': 5 },\r\n            ]\r\n        }\r\n    }\r\n];\r\n\r\nexport default function DatasetsPage() {\r\n    const router = useRouter();\r\n    const { setIncomingDataset } = useApp();\r\n    const [datasets, setDatasets] = useState(MOCK_DATASETS);\r\n    const [searchQuery, setSearchQuery] = useState('');\r\n    const [drawerOpen, setDrawerOpen] = useState(false);\r\n    const [activeTable, setActiveTable] = useState<{ data: TableData, name: string } | null>(null);\r\n\r\n    // Filter & Menu State\r\n    const [filterOpen, setFilterOpen] = useState(false);\r\n    const [selectedSources, setSelectedSources] = useState<string[]>([]);\r\n    const [activeMenuId, setActiveMenuId] = useState<string | null>(null);\r\n    const filterRef = useRef<HTMLDivElement>(null);\r\n\r\n    const handleExpand = (data: TableData, name: string) => {\r\n        setActiveTable({ data, name });\r\n        setDrawerOpen(true);\r\n    };\r\n\r\n    // Close filter when clicking outside\r\n    useEffect(() => {\r\n        const handleClickOutside = (event: MouseEvent) => {\r\n            if (filterRef.current && !filterRef.current.contains(event.target as Node)) {\r\n                setFilterOpen(false);\r\n            }\r\n        };\r\n        document.addEventListener('mousedown', handleClickOutside);\r\n        return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }, []);\r\n\r\n    // Extract unique sources for filter\r\n    const sources = Array.from(new Set(MOCK_DATASETS.map(d => d.source)));\r\n\r\n    const toggleSource = (source: string) => {\r\n        setSelectedSources(prev =>\r\n            prev.includes(source) ? prev.filter(s => s !== source) : [...prev, source]\r\n        );\r\n    };\r\n\r\n    // Filter Logic\r\n    const displayedDatasets = datasets.filter(d => {\r\n        const matchesSearch =\r\n            d.name.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n            d.source.toLowerCase().includes(searchQuery.toLowerCase()) ||\r\n            d.type.toLowerCase().includes(searchQuery.toLowerCase());\r\n\r\n        const matchesSource = selectedSources.length === 0 || selectedSources.includes(d.source);\r\n\r\n        return matchesSearch && matchesSource;\r\n    });\r\n\r\n    const handleOpenInChat = (ds: typeof MOCK_DATASETS[0]) => {\r\n        // Set global context and redirect to home\r\n        setIncomingDataset({ name: ds.name, data: ds.data, source: ds.source });\r\n        setActiveMenuId(null);\r\n        router.push('/');\r\n    };\r\n\r\n    const handleDuplicate = (id: string) => {\r\n        const original = datasets.find(d => d.id === id);\r\n        if (original) {\r\n            const newDs = {\r\n                ...original,\r\n                id: Date.now().toString(),\r\n                name: `${original.name} (Copy)`,\r\n                updated: 'Just now',\r\n                status: 'Not deployed' // Reset status for copy\r\n            };\r\n            setDatasets([newDs, ...datasets]);\r\n        }\r\n        setActiveMenuId(null);\r\n    };\r\n\r\n    const handleDelete = (id: string) => {\r\n        setDatasets(datasets.filter(d => d.id !== id));\r\n        setActiveMenuId(null);\r\n    };\r\n\r\n    const handleArchive = (id: string) => {\r\n        // Treating archive as delete for the list view for now\r\n        handleDelete(id);\r\n    };\r\n\r\n    return (\r\n        <div className=\"p-6 md:p-10 pb-20 max-w-[1600px] mx-auto\" onClick={() => setActiveMenuId(null)}>\r\n\r\n            {/* Header */}\r\n            <div className=\"flex flex-col lg:flex-row lg:items-center justify-between mb-8 gap-6\">\r\n                <div>\r\n                    <h1 className=\"text-3xl font-bold text-gray-900 dark:text-white tracking-tight mb-2\">Datasets</h1>\r\n                    <p className=\"text-gray-500 dark:text-gray-400\">Manage and analyze your connected data sources.</p>\r\n                </div>\r\n\r\n                {/* Toolbar */}\r\n                <div className=\"flex flex-col sm:flex-row items-center gap-3 w-full lg:w-auto z-20\">\r\n\r\n                    {/* Search Bar */}\r\n                    <div className=\"relative w-full sm:w-72 group\">\r\n                        <div className=\"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none\">\r\n                            <Search size={16} className=\"text-gray-400 group-focus-within:text-blue-500 transition-colors duration-200\" />\r\n                        </div>\r\n                        <input\r\n                            type=\"text\"\r\n                            placeholder=\"Search datasets...\"\r\n                            value={searchQuery}\r\n                            onChange={(e) => setSearchQuery(e.target.value)}\r\n                            className=\"block w-full pl-10 pr-3 py-2 bg-white dark:bg-[#1f1f1f] border border-gray-200 dark:border-[#333] rounded-lg text-sm text-gray-900 dark:text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/20 focus:border-blue-500 transition-all shadow-sm\"\r\n                        />\r\n                    </div>\r\n\r\n                    <div className=\"flex items-center gap-3 w-full sm:w-auto\">\r\n                        {/* Filter Menu */}\r\n                        <div className=\"relative flex-1 sm:flex-none\" ref={filterRef}>\r\n                            <button\r\n                                onClick={(e) => { e.stopPropagation(); setFilterOpen(!filterOpen); }}\r\n                                className={`flex w-full items-center justify-center gap-2 px-4 py-2 bg-white dark:bg-[#1f1f1f] border border-gray-200 dark:border-[#333] rounded-lg text-sm font-medium hover:bg-gray-50 dark:hover:bg-[#2a2a2a] transition-colors text-gray-700 dark:text-gray-200 shadow-sm active:scale-95 ${filterOpen ? 'ring-2 ring-blue-500/20 border-blue-500' : ''}`}\r\n                            >\r\n                                <Filter size={16} strokeWidth={1.5} />\r\n                                <span>Filter</span>\r\n                                {selectedSources.length > 0 && (\r\n                                    <span className=\"ml-1 flex items-center justify-center w-5 h-5 bg-blue-600 text-white text-[10px] rounded-full\">\r\n                                        {selectedSources.length}\r\n                                    </span>\r\n                                )}\r\n                            </button>\r\n\r\n                            {filterOpen && (\r\n                                <div className=\"absolute top-full right-0 mt-2 w-56 bg-white dark:bg-[#1f1f1f] border border-gray-200 dark:border-[#333] rounded-xl shadow-xl overflow-hidden animate-in fade-in zoom-in-95 duration-100 z-50\">\r\n                                    <div className=\"p-2 bg-gray-50 dark:bg-[#252525] border-b border-gray-100 dark:border-[#333]\">\r\n                                        <span className=\"text-xs font-semibold text-gray-500 dark:text-gray-400 uppercase tracking-wider px-2\">Filter by Source</span>\r\n                                    </div>\r\n                                    <div className=\"p-1.5 max-h-64 overflow-y-auto custom-scrollbar\">\r\n                                        {sources.map(s => (\r\n                                            <button\r\n                                                key={s}\r\n                                                onClick={(e) => { e.stopPropagation(); toggleSource(s); }}\r\n                                                className=\"flex items-center gap-3 w-full px-2 py-2 text-sm text-left rounded-lg hover:bg-gray-100 dark:hover:bg-[#2a2a2a] transition-colors\"\r\n                                            >\r\n                                                <div className={`w-4 h-4 border rounded-md flex items-center justify-center transition-colors ${selectedSources.includes(s) ? 'bg-black dark:bg-white border-transparent' : 'border-gray-300 dark:border-[#444]'}`}>\r\n                                                    {selectedSources.includes(s) && <Check size={10} className=\"text-white dark:text-black\" strokeWidth={3} />}\r\n                                                </div>\r\n                                                <span className=\"text-gray-700 dark:text-gray-200 truncate\">{s}</span>\r\n                                            </button>\r\n                                        ))}\r\n                                        {sources.length === 0 && <div className=\"p-4 text-center text-gray-400 text-xs\">No sources found</div>}\r\n                                    </div>\r\n                                    {selectedSources.length > 0 && (\r\n                                        <div className=\"p-2 border-t border-gray-100 dark:border-[#333]\">\r\n                                            <button onClick={() => setSelectedSources([])} className=\"w-full py-1.5 text-xs font-medium text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-lg transition-colors\">\r\n                                                Clear Filters\r\n                                            </button>\r\n                                        </div>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n                        </div>\r\n\r\n                        <button className=\"flex-1 sm:flex-none flex items-center justify-center gap-2 px-5 py-2 bg-black dark:bg-white text-white dark:text-black border border-transparent rounded-lg text-sm font-medium hover:opacity-90 transition-opacity shadow-sm active:scale-95\">\r\n                            <Plus size={16} strokeWidth={1.5} />\r\n                            <span className=\"hidden sm:inline\">Import Data</span>\r\n                            <span className=\"sm:hidden\">Import</span>\r\n                        </button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            {/* Grid */}\r\n            <div className=\"grid grid-cols-1 xl:grid-cols-2 2xl:grid-cols-3 gap-6\">\r\n                {displayedDatasets.map((ds) => (\r\n                    <div\r\n                        key={ds.id}\r\n                        onClick={(e) => {\r\n                            e.stopPropagation();\r\n                            setActiveMenuId(activeMenuId === ds.id ? null : ds.id);\r\n                        }}\r\n                        className={`\r\n               relative flex flex-col gap-3 p-2 rounded-2xl transition-all duration-200 group border border-transparent\r\n               hover:bg-gray-50 dark:hover:bg-[#1a1a1a] cursor-pointer\r\n               ${activeMenuId === ds.id ? 'bg-gray-50 dark:bg-[#1a1a1a]' : ''}\r\n            `}\r\n                    >\r\n                        {/* Context Menu Overlay */}\r\n                        {activeMenuId === ds.id && (\r\n                            <div\r\n                                className=\"absolute inset-0 z-50 flex items-center justify-center bg-white/40 dark:bg-black/40 backdrop-blur-[1px] rounded-2xl animate-in fade-in duration-200\"\r\n                                onClick={(e) => { e.stopPropagation(); setActiveMenuId(null); }}\r\n                            >\r\n                                <div className=\"bg-white dark:bg-[#1e1e1e] border border-gray-200 dark:border-[#333] shadow-2xl p-1.5 min-w-[220px] rounded-xl animate-in zoom-in-95 slide-in-from-bottom-2 duration-200\">\r\n                                    <div className=\"space-y-0.5\">\r\n                                        <button\r\n                                            onClick={(e) => { e.stopPropagation(); setActiveMenuId(null); }}\r\n                                            className=\"group flex items-center gap-3 w-full px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-[#2a2a2a] transition-colors rounded-md\"\r\n                                        >\r\n                                            <BookOpen size={16} className=\"text-gray-500 dark:text-gray-400 group-hover:text-black dark:group-hover:text-white transition-colors\" />\r\n                                            <span>Open in Notebook</span>\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={(e) => { e.stopPropagation(); handleOpenInChat(ds); }}\r\n                                            className=\"group flex items-center gap-3 w-full px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-[#2a2a2a] transition-colors rounded-md\"\r\n                                        >\r\n                                            <MessageSquare size={16} className=\"text-gray-500 dark:text-gray-400 group-hover:text-black dark:group-hover:text-white transition-colors\" />\r\n                                            <span>Open in Chat</span>\r\n                                        </button>\r\n                                    </div>\r\n\r\n                                    <div className=\"h-px bg-gray-100 dark:bg-[#333] my-1.5 mx-1\"></div>\r\n\r\n                                    <div className=\"space-y-0.5\">\r\n                                        <button\r\n                                            onClick={(e) => { e.stopPropagation(); handleDuplicate(ds.id); }}\r\n                                            className=\"group flex items-center gap-3 w-full px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-[#2a2a2a] transition-colors rounded-md\"\r\n                                        >\r\n                                            <Copy size={16} className=\"text-gray-500 dark:text-gray-400 group-hover:text-black dark:group-hover:text-white transition-colors\" />\r\n                                            <span>Duplicate</span>\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={(e) => { e.stopPropagation(); handleArchive(ds.id); }}\r\n                                            className=\"group flex items-center gap-3 w-full px-3 py-2 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-100 dark:hover:bg-[#2a2a2a] transition-colors rounded-md\"\r\n                                        >\r\n                                            <Archive size={16} className=\"text-gray-500 dark:text-gray-400 group-hover:text-black dark:group-hover:text-white transition-colors\" />\r\n                                            <span>Archive</span>\r\n                                        </button>\r\n                                    </div>\r\n\r\n                                    <div className=\"h-px bg-gray-100 dark:bg-[#333] my-1.5 mx-1\"></div>\r\n\r\n                                    <button\r\n                                        onClick={(e) => { e.stopPropagation(); handleDelete(ds.id); }}\r\n                                        className=\"group flex items-center gap-3 w-full px-3 py-2 text-sm font-medium text-red-600 hover:bg-red-50 dark:hover:bg-red-900/20 transition-colors rounded-md\"\r\n                                    >\r\n                                        <Trash2 size={16} className=\"text-red-500 dark:text-red-400 group-hover:text-red-600 dark:group-hover:text-red-300 transition-colors\" />\r\n                                        <span>Delete</span>\r\n                                    </button>\r\n                                </div>\r\n                            </div>\r\n                        )}\r\n\r\n                        {/* The Table Component */}\r\n                        <div className=\"w-full relative shadow-sm rounded-xl overflow-hidden transition-shadow duration-300 border border-gray-200 dark:border-[#333] bg-white dark:bg-[#1e1e1e]\">\r\n                            <EmbeddedTable\r\n                                data={ds.data}\r\n                                fileName={ds.name}\r\n                                source={ds.source}\r\n                                visualHint={ds.visualHint}\r\n                                onExpand={() => handleExpand(ds.data, ds.name)}\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Metadata Footer */}\r\n                        <div className=\"px-2 flex justify-between items-center min-h-[24px]\">\r\n                            <div className=\"flex flex-col gap-0.5\">\r\n                                <div className=\"flex items-center gap-2 text-xs text-gray-500 dark:text-gray-400 font-medium\">\r\n                                    {ds.status === 'Deployed' && (\r\n                                        <>\r\n                                            <span className=\"flex items-center gap-1.5 text-green-600 dark:text-green-400\">\r\n                                                <CheckCircle2 size={12} />\r\n                                                {ds.status}\r\n                                            </span>\r\n                                            <span className=\"text-gray-300 dark:text-gray-600\">•</span>\r\n                                        </>\r\n                                    )}\r\n                                    <span className=\"text-[11px] text-gray-400\">{ds.updated}</span>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div className=\"flex items-center gap-2\">\r\n                                <span className=\"text-[10px] font-bold text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-[#2a2a2a] px-2 py-0.5 rounded border border-gray-200 dark:border-[#333] uppercase tracking-wider\">\r\n                                    {ds.type}\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                ))}\r\n\r\n                {/* Empty State for Search/Filter */}\r\n                {displayedDatasets.length === 0 && (\r\n                    <div className=\"col-span-full flex flex-col items-center justify-center py-20 text-gray-400\">\r\n                        <div className=\"w-16 h-16 bg-gray-100 dark:bg-[#2a2a2a] rounded-full flex items-center justify-center mb-4\">\r\n                            <Search size={24} strokeWidth={1.5} className=\"opacity-50\" />\r\n                        </div>\r\n                        <p className=\"text-sm font-medium\">No datasets found matching your criteria.</p>\r\n                        <button onClick={() => { setSearchQuery(''); setSelectedSources([]); }} className=\"mt-2 text-xs text-blue-600 hover:underline\">Clear all filters</button>\r\n                    </div>\r\n                )}\r\n            </div>\r\n\r\n            {/* Drawer for Full View */}\r\n            <TableDrawer\r\n                isOpen={drawerOpen}\r\n                data={activeTable?.data || null}\r\n                fileName={activeTable?.name || ''}\r\n                onClose={() => setDrawerOpen(false)}\r\n                onSave={() => { }}\r\n            />\r\n        </div>\r\n    );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}