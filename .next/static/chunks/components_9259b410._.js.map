{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/components/chat/EmbeddedTable.tsx"],"sourcesContent":["\r\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { TableData } from '../../types/chat';\r\nimport { Maximize2, BarChart3, Database } from 'lucide-react';\r\n\r\ninterface EmbeddedTableProps {\r\n  data: TableData;\r\n  fileName: string;\r\n  visualHint?: string;\r\n  source?: string;\r\n  onExpand: () => void;\r\n}\r\n\r\nexport const EmbeddedTable: React.FC<EmbeddedTableProps> = ({ data, fileName, visualHint, source, onExpand }) => {\r\n  // Local state for editing and resizing\r\n  const [rows, setRows] = useState<any[]>([]);\r\n  const [headers, setHeaders] = useState<string[]>([]);\r\n  const [colWidths, setColWidths] = useState<Record<string, number>>({});\r\n  \r\n  // Interaction State\r\n  const [selectedCell, setSelectedCell] = useState<{r: number, c: string} | null>(null);\r\n  \r\n  // Resizing State\r\n  const resizingRef = useRef<{ startX: number, startWidth: number, header: string } | null>(null);\r\n\r\n  useEffect(() => {\r\n    // Sync with props (e.g. if updated from drawer)\r\n    setRows(data.rows.slice(0, 5)); // Only show first 5 rows in embedded view\r\n    setHeaders(data.headers);\r\n    \r\n    // Initialize widths\r\n    const initialWidths: Record<string, number> = {};\r\n    data.headers.forEach(h => initialWidths[h] = 120);\r\n    setColWidths(initialWidths);\r\n  }, [data]);\r\n\r\n  // --- Resizing Logic ---\r\n  const handleMouseDown = (e: React.MouseEvent, header: string) => {\r\n    e.preventDefault();\r\n    resizingRef.current = {\r\n      startX: e.clientX,\r\n      startWidth: colWidths[header] || 120,\r\n      header\r\n    };\r\n    document.addEventListener('mousemove', handleMouseMove);\r\n    document.addEventListener('mouseup', handleMouseUp);\r\n  };\r\n\r\n  const handleMouseMove = useCallback((e: MouseEvent) => {\r\n    if (!resizingRef.current) return;\r\n    const { startX, startWidth, header } = resizingRef.current;\r\n    const diff = e.clientX - startX;\r\n    setColWidths(prev => ({\r\n      ...prev,\r\n      [header]: Math.max(50, startWidth + diff)\r\n    }));\r\n  }, []);\r\n\r\n  const handleMouseUp = useCallback(() => {\r\n    resizingRef.current = null;\r\n    document.removeEventListener('mousemove', handleMouseMove);\r\n    document.removeEventListener('mouseup', handleMouseUp);\r\n  }, [handleMouseMove]);\r\n\r\n  // --- Interaction Logic ---\r\n  const handleCellClick = (r: number, c: string) => {\r\n    setSelectedCell({ r, c });\r\n  };\r\n\r\n  // Helper to get column letter (A, B, C...)\r\n  const getColLetter = (index: number) => String.fromCharCode(65 + index);\r\n\r\n  return (\r\n    <div className=\"w-full border border-gray-300 dark:border-[#444] bg-white dark:bg-[#1e1e1e] shadow-sm select-none flex flex-col rounded-xl overflow-hidden font-sans transition-all hover:shadow-md group\">\r\n      {/* Top Bar */}\r\n      <div className=\"flex items-center justify-between px-3 py-2 bg-[#f8f9fa] dark:bg-[#252525] border-b border-gray-300 dark:border-[#444]\">\r\n        <div className=\"flex items-center gap-3 min-w-0\">\r\n          <div className={`flex-shrink-0 w-8 h-8 rounded-lg flex items-center justify-center ${visualHint ? 'bg-purple-600' : 'bg-[#107c41]'}`}>\r\n             {visualHint ? <BarChart3 size={16} className=\"text-white\" /> : <Database size={16} className=\"text-white\" />}\r\n          </div>\r\n          <div className=\"flex flex-col min-w-0\">\r\n             <div className=\"flex items-center gap-2\">\r\n                <span className=\"text-xs font-semibold text-gray-900 dark:text-gray-100 truncate\">{fileName}</span>\r\n                {source && (\r\n                    <span className=\"px-1.5 py-0.5 rounded-md bg-gray-200 dark:bg-[#333] text-[9px] font-semibold text-gray-600 dark:text-gray-300 uppercase tracking-wide border border-gray-300 dark:border-[#444]\">\r\n                        {source}\r\n                    </span>\r\n                )}\r\n             </div>\r\n             {visualHint && <span className=\"text-[9px] text-purple-600 dark:text-purple-400 uppercase font-bold tracking-wide\">Analysis Ready</span>}\r\n          </div>\r\n        </div>\r\n        <button \r\n            onClick={onExpand}\r\n            className=\"flex-shrink-0 flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium bg-white dark:bg-[#333] text-gray-700 dark:text-gray-200 border border-gray-200 dark:border-[#444] hover:bg-gray-50 dark:hover:bg-[#404040] rounded-full transition-colors shadow-sm\"\r\n        >\r\n            <Maximize2 size={12} strokeWidth={2} />\r\n            <span className=\"hidden sm:inline\">Expand</span>\r\n        </button>\r\n      </div>\r\n\r\n      {/* Excel Grid */}\r\n      <div className=\"overflow-x-auto relative no-scrollbar bg-white dark:bg-[#1e1e1e]\">\r\n        <div className=\"inline-block min-w-full\">\r\n            {/* Headers */}\r\n            <div className=\"flex\">\r\n                {/* Row Number Header */}\r\n                <div className=\"w-10 flex-shrink-0 bg-[#f3f2f1] dark:bg-[#2b2b2b] border-r border-b border-gray-300 dark:border-[#444] h-8\"></div>\r\n                {headers.map((h, i) => (\r\n                    <div \r\n                        key={h} \r\n                        className=\"relative flex-shrink-0 flex items-center justify-center bg-[#f3f2f1] dark:bg-[#2b2b2b] border-r border-b border-gray-300 dark:border-[#444] h-8 text-[11px] font-bold text-gray-600 dark:text-gray-300\"\r\n                        style={{ width: colWidths[h] }}\r\n                    >\r\n                        {h} ({getColLetter(i)})\r\n                        {/* Resizer Handle */}\r\n                        <div \r\n                            className=\"absolute right-0 top-0 bottom-0 w-1 cursor-col-resize hover:bg-[#107c41] z-10\"\r\n                            onMouseDown={(e) => handleMouseDown(e, h)}\r\n                        />\r\n                    </div>\r\n                ))}\r\n            </div>\r\n\r\n            {/* Rows */}\r\n            {rows.map((row, rIdx) => (\r\n                <div key={rIdx} className=\"flex group\">\r\n                    {/* Row Number */}\r\n                    <div className=\"w-10 flex-shrink-0 flex items-center justify-center bg-[#f3f2f1] dark:bg-[#2b2b2b] border-r border-b border-gray-300 dark:border-[#444] text-[10px] text-gray-500 dark:text-gray-400 font-mono select-none group-hover:bg-[#e1dfdd] dark:group-hover:bg-[#333]\">\r\n                        {rIdx + 1}\r\n                    </div>\r\n                    \r\n                    {/* Cells */}\r\n                    {headers.map((h) => {\r\n                        const isSelected = selectedCell?.r === rIdx && selectedCell?.c === h;\r\n\r\n                        return (\r\n                            <div \r\n                                key={h}\r\n                                className={`\r\n                                    relative flex-shrink-0 h-7 text-xs border-r border-b border-gray-200 dark:border-[#444] px-2 flex items-center\r\n                                    ${rIdx % 2 === 0 ? 'bg-white dark:bg-[#1e1e1e]' : 'bg-[#fafafa] dark:bg-[#232323]'} \r\n                                    ${isSelected ? 'outline outline-2 outline-[#107c41] z-10' : ''}\r\n                                `}\r\n                                style={{ width: colWidths[h] }}\r\n                                onClick={() => handleCellClick(rIdx, h)}\r\n                            >\r\n                                <span className=\"truncate w-full text-gray-800 dark:text-gray-200 pointer-events-none\">\r\n                                    {row[h]}\r\n                                </span>\r\n                            </div>\r\n                        );\r\n                    })}\r\n                </div>\r\n            ))}\r\n        </div>\r\n      </div>\r\n\r\n      {/* Footer */}\r\n      <div className=\"px-3 py-2 bg-[#f8f9fa] dark:bg-[#252525] border-t border-gray-300 dark:border-[#444] flex justify-between items-center\">\r\n        <span className=\"text-[10px] font-medium text-gray-500 dark:text-gray-400\">\r\n           {rows.length < data.rows.length ? `Previewing ${rows.length} of ${data.rows.length} rows` : `${rows.length} rows`}\r\n        </span>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 331, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/components/table/types.ts"],"sourcesContent":["\r\nexport interface NotebookBlock {\r\n  type: 'text' | 'chart' | 'stat';\r\n  content?: string; // For text\r\n  title?: string;\r\n  // For charts\r\n  chartType?: 'bar' | 'line' | 'pie' | 'area';\r\n  xAxis?: string;\r\n  yAxis?: string;\r\n  aggregation?: 'sum' | 'count' | 'average';\r\n  explanation?: string;\r\n  // For stats\r\n  statValue?: string;\r\n  statLabel?: string;\r\n  trend?: 'up' | 'down' | 'neutral';\r\n}\r\n\r\nexport interface NotebookReport {\r\n  title: string;\r\n  summary: string;\r\n  blocks: NotebookBlock[];\r\n}\r\n\r\nexport const COLOR_THEMES: Record<string, string[]> = {\r\n  green: ['#107c41', '#21a366', '#33c481', '#185c37', '#0b5a2d'],\r\n  blue: ['#007AFF', '#5856D6', '#00C7BE', '#32ADE6', '#007AFF'],\r\n  purple: ['#AF52DE', '#BF5AF2', '#DA8FFF', '#5E5CE6', '#7D54DE'],\r\n  orange: ['#FF9500', '#FF3B30', '#FF2D55', '#FFCC00', '#FF9500'],\r\n  gray: ['#8E8E93', '#AEAEB2', '#C7C7CC', '#48484A', '#1C1C1E'],\r\n};\r\n"],"names":[],"mappings":";;;AAuBO,MAAM,eAAyC;IACpD,OAAO;QAAC;QAAW;QAAW;QAAW;QAAW;KAAU;IAC9D,MAAM;QAAC;QAAW;QAAW;QAAW;QAAW;KAAU;IAC7D,QAAQ;QAAC;QAAW;QAAW;QAAW;QAAW;KAAU;IAC/D,QAAQ;QAAC;QAAW;QAAW;QAAW;QAAW;KAAU;IAC/D,MAAM;QAAC;QAAW;QAAW;QAAW;QAAW;KAAU;AAC/D","debugId":null}},
    {"offset": {"line": 380, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/components/chat/ChatChart.tsx"],"sourcesContent":["\r\nimport React, { useMemo } from 'react';\r\nimport {\r\n  BarChart, Bar, XAxis, YAxis, CartesianGrid, Tooltip, ResponsiveContainer,\r\n  PieChart, Pie, Cell, LineChart, Line, Legend\r\n} from 'recharts';\r\nimport { Maximize2, BarChart3 } from 'lucide-react';\r\nimport { TableData } from '../../types/chat';\r\nimport { COLOR_THEMES } from '../table/types';\r\n\r\ninterface ChatChartProps {\r\n  data: TableData;\r\n  type: 'bar' | 'line' | 'pie' | 'area' | string;\r\n  onExpand?: () => void;\r\n}\r\n\r\nexport const ChatChart: React.FC<ChatChartProps> = ({ data, type, onExpand }) => {\r\n  const { headers, rows } = data;\r\n\r\n  const chartInfo = useMemo(() => {\r\n    if (!rows || rows.length === 0) return null;\r\n    \r\n    const firstRow = rows[0];\r\n    const labelKey = headers.find(h => typeof firstRow[h] === 'string') || headers[0];\r\n    const valueKeys = headers.filter(h => typeof firstRow[h] === 'number' && h !== labelKey);\r\n    const finalValueKeys = valueKeys.length > 0 ? valueKeys : headers.filter(h => h !== labelKey).slice(0, 1);\r\n    \r\n    return { labelKey, valueKeys: finalValueKeys };\r\n  }, [headers, rows]);\r\n\r\n  if (!chartInfo || rows.length === 0) return null;\r\n\r\n  const colors = COLOR_THEMES['blue'];\r\n  const monoFont = { fontFamily: 'JetBrains Mono, monospace', fontSize: 10, fontWeight: 500 };\r\n\r\n  return (\r\n    <div className=\"w-full my-6 bg-white dark:bg-[#1e1e1e] rounded-3xl border border-gray-200 dark:border-[#333] overflow-hidden shadow-sm hover:shadow-md transition-all duration-300\">\r\n      {/* Chart Header - Standardized to match CodeBlock */}\r\n      <div className=\"px-4 py-2.5 bg-gray-50 dark:bg-[#262626] border-b border-gray-200 dark:border-[#333] flex items-center justify-between\">\r\n          <div className=\"flex items-center gap-2\">\r\n              <div className=\"flex gap-1.5 mr-2\">\r\n                  {[1, 2, 3].map(i => <div key={i} className=\"w-2.5 h-2.5 rounded-full bg-gray-300 dark:bg-gray-600\" />)}\r\n              </div>\r\n              <span className=\"text-xs font-mono text-gray-500 dark:text-gray-400 lowercase\">visual_insight</span>\r\n          </div>\r\n          <button \r\n            onClick={onExpand}\r\n            className=\"flex items-center gap-1.5 text-xs font-medium text-gray-500 hover:text-gray-900 dark:text-gray-400 dark:hover:text-white transition-colors\"\r\n          >\r\n            <Maximize2 size={14} />\r\n            <span>Expand</span>\r\n          </button>\r\n      </div>\r\n\r\n      {/* Chart Canvas */}\r\n      <div className=\"w-full h-72 p-6\">\r\n        <ResponsiveContainer width=\"100%\" height=\"100%\">\r\n          {type === 'pie' ? (\r\n            <PieChart>\r\n              <Pie\r\n                data={rows}\r\n                dataKey={chartInfo.valueKeys[0]}\r\n                nameKey={chartInfo.labelKey}\r\n                cx=\"50%\"\r\n                cy=\"50%\"\r\n                outerRadius={80}\r\n                innerRadius={50}\r\n                paddingAngle={4}\r\n                stroke=\"none\"\r\n              >\r\n                {rows.map((_, index) => (\r\n                  <Cell key={`cell-${index}`} fill={colors[index % colors.length]} />\r\n                ))}\r\n              </Pie>\r\n              <Tooltip \r\n                  contentStyle={{ borderRadius: '16px', border: 'none', boxShadow: '0 10px 25px rgba(0,0,0,0.1)', fontSize: '11px', fontFamily: 'JetBrains Mono' }}\r\n              />\r\n              <Legend verticalAlign=\"bottom\" height={36} iconType=\"circle\" wrapperStyle={{ fontSize: '10px', fontFamily: 'JetBrains Mono', textTransform: 'uppercase' }} />\r\n            </PieChart>\r\n          ) : type === 'line' ? (\r\n            <LineChart data={rows} margin={{ top: 10, right: 10, left: -10, bottom: 0 }}>\r\n              <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"rgba(0,0,0,0.05)\" />\r\n              <XAxis \r\n                dataKey={chartInfo.labelKey} \r\n                axisLine={false} \r\n                tickLine={false} \r\n                tick={{ ...monoFont, fill: '#999' }} \r\n                dy={10}\r\n              />\r\n              <YAxis \r\n                axisLine={false} \r\n                tickLine={false} \r\n                tick={{ ...monoFont, fill: '#999' }} \r\n              />\r\n              <Tooltip \r\n                contentStyle={{ borderRadius: '16px', border: 'none', boxShadow: '0 10px 25px rgba(0,0,0,0.1)', fontFamily: 'JetBrains Mono', fontSize: '11px' }}\r\n              />\r\n              {chartInfo.valueKeys.map((key, i) => (\r\n                <Line \r\n                  key={key} \r\n                  type=\"monotone\" \r\n                  dataKey={key} \r\n                  stroke={colors[i % colors.length]} \r\n                  strokeWidth={3} \r\n                  dot={{ r: 5, strokeWidth: 2, fill: '#fff' }} \r\n                  activeDot={{ r: 7, strokeWidth: 0 }}\r\n                />\r\n              ))}\r\n            </LineChart>\r\n          ) : (\r\n            <BarChart data={rows} margin={{ top: 10, right: 10, left: -10, bottom: 0 }}>\r\n              <CartesianGrid strokeDasharray=\"3 3\" vertical={false} stroke=\"rgba(0,0,0,0.05)\" />\r\n              <XAxis \r\n                dataKey={chartInfo.labelKey} \r\n                axisLine={false} \r\n                tickLine={false} \r\n                tick={{ ...monoFont, fill: '#999' }} \r\n                dy={10}\r\n              />\r\n              <YAxis \r\n                axisLine={false} \r\n                tickLine={false} \r\n                tick={{ ...monoFont, fill: '#999' }} \r\n              />\r\n              <Tooltip \r\n                cursor={{ fill: 'rgba(0,0,0,0.02)' }}\r\n                contentStyle={{ borderRadius: '16px', border: 'none', boxShadow: '0 10px 25px rgba(0,0,0,0.1)', fontFamily: 'JetBrains Mono', fontSize: '11px' }}\r\n              />\r\n              {chartInfo.valueKeys.map((key, i) => (\r\n                <Bar \r\n                  key={key} \r\n                  dataKey={key} \r\n                  fill={colors[i % colors.length]} \r\n                  radius={[6, 6, 0, 0]} \r\n                  barSize={32}\r\n                />\r\n              ))}\r\n            </BarChart>\r\n          )}\r\n        </ResponsiveContainer>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 762, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/girum/Downloads/New%20folder%20%284%29/Auxilary-Redesign/components/NotebookEditor.tsx"],"sourcesContent":["/**\r\n * NotebookEditor.tsx\r\n * \r\n * Purpose: \r\n * A rich code editor environment simulating a Jupyter notebook.\r\n * Executes Python code in the browser using WebAssembly (Pyodide).\r\n * \r\n * Outline:\r\n * - NotebookEditor: Main component managing cell state and Pyodide runtime.\r\n * - Cells: Code (executable) or Markdown (text) blocks.\r\n * - Pyodide Integration: Loads generic Python environment for client-side execution.\r\n */\r\n\r\n'use client';\r\n\r\nimport React, { useState, useRef, useEffect, useCallback } from 'react';\r\nimport { useRouter } from 'next/navigation';\r\nimport {\r\n    Play, Plus, Trash2, GripVertical, ChevronDown,\r\n    Cpu, Zap, Database, Terminal, FileText, Check,\r\n    RotateCw, Save, ArrowLeft, Image as ImageIcon, BarChart3, AlertCircle,\r\n    Code2, Type, PenLine, Search, List, CheckSquare, MessageSquare, Minus,\r\n    Heading1, Heading2, Heading3\r\n} from 'lucide-react';\r\nimport { Notebook, NotebookCell, Environment, Compute } from '../types';\r\nimport ReactMarkdown from 'react-markdown';\r\nimport remarkGfm from 'remark-gfm';\r\nimport { EmbeddedTable } from './chat/EmbeddedTable';\r\nimport { ChatChart } from './chat/ChatChart';\r\nimport { MarkdownRenderer } from './chat/MarkdownRenderer';\r\nimport { TableData } from '../types/chat';\r\n\r\n// Add global type for pyodide\r\ndeclare global {\r\n    interface Window {\r\n        loadPyodide: any;\r\n        pyodide: any;\r\n    }\r\n}\r\n\r\ninterface NotebookEditorProps {\r\n    notebook: Notebook;\r\n    onBack?: () => void;\r\n}\r\n\r\nconst textBlockTypes = [\r\n    { id: 'paragraph', label: 'Paragraph', icon: Type, prefix: '', shortcut: 'abc' },\r\n    { id: 'h1', label: 'Heading 1', icon: Heading1, prefix: '# ', shortcut: 'H1' },\r\n    { id: 'h2', label: 'Heading 2', icon: Heading2, prefix: '## ', shortcut: 'H2' },\r\n    { id: 'h3', label: 'Heading 3', icon: Heading3, prefix: '### ', shortcut: 'H3' },\r\n    { id: 'bullet', label: 'Bulleted list', icon: List, prefix: '- ', shortcut: 'â€¢' },\r\n    { id: 'todo', label: 'To-do list', icon: CheckSquare, prefix: '- [ ] ', shortcut: 'â˜‘' },\r\n    { id: 'callout', label: 'Callout', icon: MessageSquare, prefix: '> **Note**\\n> ', shortcut: 'ðŸ’¬' },\r\n    { id: 'markdown', label: 'Markdown', icon: FileText, prefix: '', shortcut: 'Mâ†“' },\r\n    { id: 'separator', label: 'Separator', icon: Minus, prefix: '---\\n', shortcut: 'â€”' },\r\n];\r\n\r\n// --- Sub-components extracted for performance ---\r\n\r\nconst EnvBadge = ({ env }: { env: Environment }) => {\r\n    const configs: Record<Environment, any> = {\r\n        python: { icon: Terminal, label: 'Python 3.11', color: 'text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400' },\r\n        r: { icon: FileText, label: 'R 4.2', color: 'text-blue-600 bg-blue-50 dark:bg-blue-900/20 dark:text-blue-400' },\r\n        sql: { icon: Database, label: 'SQL (AlaSQL)', color: 'text-orange-600 bg-orange-50 dark:bg-orange-900/20 dark:text-orange-400' },\r\n        'python-lite': { icon: Zap, label: 'Python Lite', color: 'text-yellow-600 bg-yellow-50 dark:bg-yellow-900/20 dark:text-yellow-400' },\r\n    };\r\n    const cfg = configs[env] || configs.python;\r\n    return (\r\n        <div className={`flex items-center gap-1.5 px-2 py-1 rounded-md text-xs font-medium border border-transparent ${cfg.color}`}>\r\n            <cfg.icon size={12} />\r\n            {cfg.label}\r\n        </div>\r\n    );\r\n};\r\n\r\nconst ComputeBadge = ({ comp }: { comp: Compute }) => {\r\n    const configs: Record<Compute, any> = {\r\n        'cpu-std': { icon: Cpu, label: 'Std (2 vCPU)', color: 'text-gray-600 bg-gray-100 dark:bg-[#333] dark:text-gray-300' },\r\n        'cpu-pro': { icon: Cpu, label: 'Pro (8 vCPU)', color: 'text-purple-600 bg-purple-50 dark:bg-purple-900/20 dark:text-purple-400' },\r\n        'gpu-t4': { icon: Zap, label: 'GPU (NVIDIA T4)', color: 'text-green-600 bg-green-50 dark:bg-green-900/20 dark:text-green-400' },\r\n        'tpu-v5': { icon: Zap, label: 'TPU v5', color: 'text-red-600 bg-red-50 dark:bg-red-900/20 dark:text-red-400' },\r\n    };\r\n    const cfg = configs[comp] || configs['cpu-std'];\r\n    return (\r\n        <div className={`flex items-center gap-1.5 px-2 py-1 rounded-md text-xs font-medium border border-transparent ${cfg.color}`}>\r\n            <cfg.icon size={12} />\r\n            {cfg.label}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport const NotebookEditor: React.FC<NotebookEditorProps> = ({ notebook: initialNotebook, onBack }) => {\r\n    const router = useRouter();\r\n\r\n    const handleBack = useCallback(() => {\r\n        if (onBack) {\r\n            onBack();\r\n        } else {\r\n            router.back();\r\n        }\r\n    }, [onBack, router]);\r\n\r\n    // State\r\n    const [title, setTitle] = useState(initialNotebook.title);\r\n    const [cells, setCells] = useState<NotebookCell[]>(initialNotebook.cells || [\r\n        { id: '1', type: 'markdown', status: 'idle', content: `# ${initialNotebook.title}\\n\\nThis notebook environment uses a real Python kernel running in your browser via WebAssembly.` },\r\n        { id: '2', type: 'code', status: 'idle', content: `import pandas as pd\\nimport numpy as np\\n\\n# Create a sample dataframe\\ndata = {\\n    'Month': ['Jan', 'Feb', 'Mar', 'Apr', 'May'],\\n    'Revenue': [12500, 14200, 11800, 15600, 16100],\\n    'Cost': [8200, 8500, 7900, 9100, 9400]\\n}\\ndf = pd.DataFrame(data)\\ndf['Profit'] = df['Revenue'] - df['Cost']\\n\\nprint(\"Data calculated successfully!\")\\ndf.head()` }\r\n    ]);\r\n    const [environment, setEnvironment] = useState<Environment>(initialNotebook.environment || 'python');\r\n    const [compute, setCompute] = useState<Compute>(initialNotebook.compute || 'cpu-std');\r\n    const [activeCellId, setActiveCellId] = useState<string | null>(null);\r\n    const [isSaving, setIsSaving] = useState(false);\r\n    const [draggedIndex, setDraggedIndex] = useState<number | null>(null);\r\n    const [activeTextDropdownId, setActiveTextDropdownId] = useState<string | null>(null);\r\n    const [activeSlashMenuId, setActiveSlashMenuId] = useState<string | null>(null);\r\n    const [textSearchQuery, setTextSearchQuery] = useState('');\r\n    const [lastSelectedPrefix, setLastSelectedPrefix] = useState<string | null>(null);\r\n\r\n    // Pyodide State\r\n    const [pyodide, setPyodide] = useState<any>(null);\r\n    const [isKernelReady, setIsKernelReady] = useState(false);\r\n    const [kernelStatus, setKernelStatus] = useState<string>('Initializing...');\r\n\r\n    // Auto-close timer for markdown cells\r\n    const activeCellLeaveTimer = useRef<NodeJS.Timeout | null>(null);\r\n\r\n    const handleCellMouseLeave = (cellId: string) => {\r\n        if (activeCellId === cellId) {\r\n            // Start 3s timer to close\r\n            if (activeCellLeaveTimer.current) clearTimeout(activeCellLeaveTimer.current);\r\n            activeCellLeaveTimer.current = setTimeout(() => {\r\n                setActiveCellId(null);\r\n            }, 3000);\r\n        }\r\n    };\r\n\r\n    const handleCellMouseEnter = () => {\r\n        // Cancel timer if re-entered\r\n        if (activeCellLeaveTimer.current) {\r\n            clearTimeout(activeCellLeaveTimer.current);\r\n            activeCellLeaveTimer.current = null;\r\n        }\r\n    };\r\n\r\n    // Initialize Pyodide\r\n    useEffect(() => {\r\n        const initPyodide = async () => {\r\n            if (window.pyodide) {\r\n                setPyodide(window.pyodide);\r\n                setIsKernelReady(true);\r\n                return;\r\n            }\r\n\r\n            if (window.loadPyodide) {\r\n                try {\r\n                    setKernelStatus('Loading Python Kernel...');\r\n                    const py = await window.loadPyodide();\r\n                    setKernelStatus('Loading micropip...');\r\n                    await py.loadPackage(\"micropip\");\r\n                    setPyodide(py);\r\n                    window.pyodide = py; // Store globally to avoid reload\r\n                    setIsKernelReady(true);\r\n                } catch (e) {\r\n                    console.error(\"Failed to load Pyodide:\", e);\r\n                    setKernelStatus('Kernel Error');\r\n                }\r\n            } else {\r\n                // Fallback if script not loaded yet (should wait or retry)\r\n                setKernelStatus('Waiting for Pyodide...');\r\n            }\r\n        };\r\n\r\n        // Small delay to ensure script tag processed\r\n        const t = setTimeout(initPyodide, 100);\r\n        return () => clearTimeout(t);\r\n    }, []);\r\n\r\n    // Close dropdown on click outside\r\n    useEffect(() => {\r\n        const handleClickOutside = (e: MouseEvent) => {\r\n            const target = e.target as HTMLElement;\r\n            if (activeTextDropdownId && !target.closest('.text-block-dropdown')) {\r\n                setActiveTextDropdownId(null);\r\n                setTextSearchQuery('');\r\n            }\r\n            if (activeSlashMenuId && !target.closest('.slash-command-menu')) {\r\n                setActiveSlashMenuId(null);\r\n                setTextSearchQuery('');\r\n            }\r\n        };\r\n        document.addEventListener('mousedown', handleClickOutside);\r\n        return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }, [activeTextDropdownId, activeSlashMenuId]);\r\n\r\n    // Handle cursor positioning after adding a cell or prefix\r\n    useEffect(() => {\r\n        if (activeCellId) {\r\n            const textarea = document.querySelector(`[data-cell-id=\"${activeCellId}\"] textarea`) as HTMLTextAreaElement;\r\n            if (textarea) {\r\n                textarea.focus();\r\n                // If it was just created or prefix added, put cursor at the end\r\n                if (lastSelectedPrefix !== null) {\r\n                    const len = textarea.value.length;\r\n                    textarea.setSelectionRange(len, len);\r\n                    setLastSelectedPrefix(null);\r\n                }\r\n            }\r\n        }\r\n    }, [activeCellId, lastSelectedPrefix]);\r\n\r\n    // Auto-resize textareas\r\n    // Not using useCallback because it's passed to native DOM events inline or simple refs\r\n    const adjustHeight = (el: HTMLTextAreaElement) => {\r\n        el.style.height = 'auto';\r\n        el.style.height = el.scrollHeight + 'px';\r\n    };\r\n\r\n    // --- Actions ---\r\n\r\n    /**\r\n     * Executes the code within a cell using the Pyodide runtime.\r\n     * Captures stdout/stderr and returns the result.\r\n     */\r\n    const handleRunCell = async (id: string) => {\r\n        const cell = cells.find(c => c.id === id);\r\n        if (!cell) return;\r\n\r\n        if (cell.type === 'markdown') {\r\n            setActiveCellId(null);\r\n            return;\r\n        }\r\n\r\n        setCells(prev => prev.map(c => c.id === id ? { ...c, status: 'running', output: undefined } : c));\r\n\r\n        if (!isKernelReady || !pyodide) {\r\n            setCells(prev => prev.map(c => c.id === id ? {\r\n                ...c,\r\n                status: 'error',\r\n                output: { type: 'error', data: \"Python kernel is not ready yet. Please wait.\" }\r\n            } : c));\r\n            return;\r\n        }\r\n\r\n        try {\r\n            // Redirect stdout\r\n            let stdout = \"\";\r\n            pyodide.setStdout({ batched: (msg: string) => { stdout += msg + \"\\n\"; } });\r\n            pyodide.setStderr({ batched: (msg: string) => { stdout += `[stderr] ${msg}\\n`; } });\r\n\r\n            // Load packages if needed (basic heuristic)\r\n            if (cell.content.includes(\"pandas\") || cell.content.includes(\"numpy\")) {\r\n                await pyodide.loadPackage([\"pandas\", \"numpy\"]);\r\n            }\r\n            if (cell.content.includes(\"matplotlib\")) {\r\n                await pyodide.loadPackage(\"matplotlib\");\r\n            }\r\n\r\n            // Run\r\n            let result = await pyodide.runPythonAsync(cell.content);\r\n\r\n            let output: NotebookCell['output'];\r\n\r\n            // Check if result is a Pandas DataFrame (via proxy)\r\n            if (result && typeof result.to_json === 'function') {\r\n                // It's likely a dataframe, convert to JSON\r\n                const jsonStr = result.to_json(undefined, { orient: 'split' });\r\n                const parsed = JSON.parse(jsonStr);\r\n                const tableData: TableData = {\r\n                    headers: parsed.columns,\r\n                    rows: parsed.data.map((row: any[], idx: number) => {\r\n                        const r: any = { id: idx.toString() };\r\n                        parsed.columns.forEach((col: string, i: number) => {\r\n                            r[col] = row[i];\r\n                        });\r\n                        return r;\r\n                    })\r\n                };\r\n                output = { type: 'table', data: tableData };\r\n            } else if (result !== undefined) {\r\n                output = { type: 'text', data: (stdout ? stdout + \"\\n\" : \"\") + String(result) };\r\n            } else {\r\n                output = { type: 'text', data: stdout || \"âœ“ Executed successfully\" };\r\n            }\r\n\r\n            setCells(prev => prev.map(c => c.id === id ? { ...c, status: 'success', output, lastRun: new Date() } : c));\r\n\r\n        } catch (err: any) {\r\n            console.error(err);\r\n            setCells(prev => prev.map(c => c.id === id ? {\r\n                ...c,\r\n                status: 'error',\r\n                output: { type: 'error', data: String(err) }\r\n            } : c));\r\n        }\r\n    };\r\n\r\n    const handleAddCell = useCallback((type: 'code' | 'markdown', afterId?: string, initialContent?: string) => {\r\n        const newCell: NotebookCell = {\r\n            id: Date.now().toString(),\r\n            type,\r\n            content: initialContent || '',\r\n            status: 'idle'\r\n        };\r\n\r\n        setCells(prevCells => {\r\n            if (afterId) {\r\n                const idx = prevCells.findIndex(c => c.id === afterId);\r\n                const newCells = [...prevCells];\r\n                newCells.splice(idx + 1, 0, newCell);\r\n                return newCells;\r\n            } else {\r\n                return [...prevCells, newCell];\r\n            }\r\n        });\r\n        setActiveCellId(newCell.id);\r\n        if (initialContent) {\r\n            setLastSelectedPrefix(initialContent);\r\n        }\r\n    }, []);\r\n\r\n    const handleDeleteCell = useCallback((id: string) => {\r\n        setCells(prev => prev.filter(c => c.id !== id));\r\n    }, []);\r\n\r\n    const handleSplitCell = useCallback((id: string, cursorPosition: number) => {\r\n        const newId = Date.now().toString();\r\n        setCells(prevCells => {\r\n            const idx = prevCells.findIndex(c => c.id === id);\r\n            if (idx === -1) return prevCells;\r\n\r\n            const currentCell = prevCells[idx];\r\n            const contentBefore = currentCell.content.substring(0, cursorPosition);\r\n            const contentAfter = currentCell.content.substring(cursorPosition);\r\n\r\n            const newCell: NotebookCell = {\r\n                id: newId,\r\n                type: currentCell.type,\r\n                content: contentAfter,\r\n                status: 'idle'\r\n            };\r\n\r\n            const updatedCells = [...prevCells];\r\n            updatedCells[idx] = { ...currentCell, content: contentBefore };\r\n            updatedCells.splice(idx + 1, 0, newCell);\r\n            return updatedCells;\r\n        });\r\n        setActiveCellId(newId);\r\n    }, []);\r\n\r\n    const handleSave = useCallback(() => {\r\n        setIsSaving(true);\r\n        setTimeout(() => setIsSaving(false), 1000);\r\n    }, []);\r\n\r\n    // Drag and Drop reordering\r\n    const handleDragStart = useCallback((e: React.DragEvent, index: number) => {\r\n        setDraggedIndex(index);\r\n        e.dataTransfer.effectAllowed = 'move';\r\n    }, []);\r\n\r\n    const handleDragEnd = useCallback(() => {\r\n        setDraggedIndex(null);\r\n    }, []);\r\n\r\n    const handleDragOver = useCallback((e: React.DragEvent) => {\r\n        e.preventDefault();\r\n    }, []);\r\n\r\n    const handleDrop = useCallback((e: React.DragEvent, index: number) => {\r\n        e.preventDefault();\r\n        setDraggedIndex(null);\r\n\r\n        if (draggedIndex === null || draggedIndex === index) return;\r\n\r\n        setCells(prevCells => {\r\n            const updatedCells = [...prevCells];\r\n            const [movedItem] = updatedCells.splice(draggedIndex, 1);\r\n            updatedCells.splice(index, 0, movedItem);\r\n            return updatedCells;\r\n        });\r\n    }, [draggedIndex]);\r\n\r\n    return (\r\n        <div className=\"flex flex-col h-full bg-white dark:bg-[#1e1e1e] overflow-hidden animate-in fade-in duration-300\">\r\n\r\n            {/* Header */}\r\n            <header className=\"h-16 flex items-center justify-between px-6 border-b border-gray-200 dark:border-[#333] bg-white/80 dark:bg-[#1e1e1e]/80 backdrop-blur-sm z-30 flex-shrink-0\">\r\n                <div className=\"flex items-center gap-4\">\r\n                    <button onClick={handleBack} className=\"p-2 -ml-2 text-gray-400 hover:text-black dark:hover:text-white rounded-full hover:bg-gray-100 dark:hover:bg-[#333] transition-colors\">\r\n                        <ArrowLeft size={20} />\r\n                    </button>\r\n\r\n                    <div className=\"h-8 w-px bg-gray-200 dark:bg-[#333]\"></div>\r\n\r\n                    <div>\r\n                        <input\r\n                            value={title}\r\n                            onChange={(e) => setTitle(e.target.value)}\r\n                            className=\"text-base font-semibold text-gray-900 dark:text-white bg-transparent outline-none placeholder-gray-400\"\r\n                            placeholder=\"Untitled Notebook\"\r\n                        />\r\n                        <div className=\"flex items-center gap-2 mt-0.5\">\r\n                            <span className={`text-[10px] uppercase font-bold flex items-center gap-1 ${isKernelReady ? 'text-green-600 dark:text-green-400' : 'text-yellow-600 dark:text-yellow-400'}`}>\r\n                                <div className={`w-1.5 h-1.5 rounded-full ${isKernelReady ? 'bg-green-500 animate-pulse' : 'bg-yellow-500'}`}></div>\r\n                                {isKernelReady ? 'Kernel Ready' : kernelStatus}\r\n                            </span>\r\n                            <span className=\"text-[10px] text-gray-400\">â€¢ Last run: Just now</span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"flex items-center gap-3\">\r\n                    {/* Environment Selector Display */}\r\n                    <div className=\"hidden md:flex items-center gap-2 bg-gray-50 dark:bg-[#252525] p-1 rounded-lg border border-gray-200 dark:border-[#333]\">\r\n                        <EnvBadge env={environment} />\r\n                    </div>\r\n\r\n                    <div className=\"h-6 w-px bg-gray-200 dark:bg-[#333]\"></div>\r\n\r\n                    <div className=\"flex items-center gap-2\">\r\n                        <div className=\"flex items-center gap-2 px-3 py-1.5 bg-gray-50 dark:bg-[#252525] border border-gray-200 dark:border-[#333] rounded-lg text-xs font-medium transition-colors\">\r\n                            <ComputeBadge comp={compute} />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <button\r\n                        onClick={handleSave}\r\n                        className=\"flex items-center gap-2 px-4 py-2 bg-black dark:bg-white text-white dark:text-black rounded-full text-xs font-bold uppercase tracking-wider hover:opacity-90 active:scale-95 transition-all shadow-lg\"\r\n                    >\r\n                        {isSaving ? <RotateCw size={14} className=\"animate-spin\" /> : <Save size={14} />}\r\n                        <span>{isSaving ? 'Saving' : 'Save'}</span>\r\n                    </button>\r\n                </div>\r\n            </header>\r\n\r\n            {/* Editor Canvas */}\r\n            <div className=\"flex-1 overflow-y-auto bg-white dark:bg-[#1e1e1e] p-4 md:p-8 scroll-smooth\">\r\n                <div className=\"max-w-4xl mx-auto pb-32\">\r\n\r\n                    {cells.map((cell, index) => (\r\n                        <div\r\n                            key={cell.id}\r\n                            className={`group relative mb-6 transition-all duration-300 ${draggedIndex === index ? 'opacity-40 scale-95' : 'opacity-100 scale-100'} ${activeTextDropdownId === cell.id ? 'z-50' : 'z-10'}`}\r\n                            onClick={() => setActiveCellId(cell.id)}\r\n                            draggable\r\n                            onDragStart={(e) => handleDragStart(e, index)}\r\n                            onDragOver={(e) => handleDragOver(e)}\r\n                            onDragEnd={handleDragEnd}\r\n                            onDrop={(e) => handleDrop(e, index)}\r\n                        >\r\n                            {/* Cell Gutter Actions (Left) */}\r\n                            <div className=\"absolute -left-12 top-0 bottom-0 w-10 flex flex-col items-center pt-1 opacity-0 group-hover:opacity-100 transition-opacity\">\r\n                                <button\r\n                                    onClick={(e) => { e.stopPropagation(); handleRunCell(cell.id); }}\r\n                                    className={`p-2 rounded-lg bg-gray-100 dark:bg-[#333] hover:bg-green-500 hover:text-white transition-all mb-2 ${cell.status === 'running' ? 'text-green-600' : 'text-gray-400'}`}\r\n                                >\r\n                                    {cell.status === 'running' ? <RotateCw size={14} className=\"animate-spin\" /> : <Play size={14} fill=\"currentColor\" />}\r\n                                </button>\r\n                                <div\r\n                                    className=\"p-1.5 text-gray-300 hover:text-gray-600 dark:hover:text-gray-300 cursor-grab active:cursor-grabbing\"\r\n                                >\r\n                                    <GripVertical size={14} />\r\n                                </div>\r\n                            </div>\r\n\r\n                            {/* Main Cell Content */}\r\n                            <div className={`\r\n                    relative rounded-xl border transition-all duration-200\r\n                    ${activeCellId === cell.id\r\n                                    ? 'border-blue-500 ring-4 ring-blue-500/5 bg-white dark:bg-[#252525] shadow-sm'\r\n                                    : 'border-transparent hover:border-gray-200 dark:hover:border-[#333] bg-transparent'\r\n                                }\r\n                `}>\r\n\r\n                                {/* Input Area */}\r\n                                {cell.type === 'code' ? (\r\n                                    <div className={`bg-[#f5f5f7] dark:bg-[#1a1a1a] rounded-xl overflow-hidden border border-gray-200 dark:border-[#333] transition-all duration-500 ${activeCellId === cell.id ? 'animate-in fade-in slide-in-from-top-2' : ''}`}>\r\n                                        <div className=\"flex items-center justify-between px-3 py-1.5 border-b border-gray-200 dark:border-[#333] bg-gray-50/50 dark:bg-[#2a2a2a]\">\r\n                                            <span className=\"text-[10px] font-mono text-gray-400\">In [{index + 1}]:</span>\r\n                                            <div className=\"flex items-center gap-2\">\r\n                                                <button onClick={() => handleDeleteCell(cell.id)} className=\"p-1 text-gray-400 hover:text-red-500 transition-colors\"><Trash2 size={12} /></button>\r\n                                            </div>\r\n                                        </div>\r\n                                        <div className=\"p-4 relative\">\r\n                                            <textarea\r\n                                                className=\"w-full bg-transparent outline-none font-mono text-sm text-gray-800 dark:text-gray-200 resize-none\"\r\n                                                value={cell.content}\r\n                                                autoFocus={activeCellId === cell.id}\r\n                                                onChange={(e) => {\r\n                                                    setCells(cells.map(c => c.id === cell.id ? { ...c, content: e.target.value } : c));\r\n                                                    adjustHeight(e.target);\r\n                                                }}\r\n                                                onKeyDown={(e) => {\r\n                                                    if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {\r\n                                                        e.preventDefault();\r\n                                                        handleSplitCell(cell.id, e.currentTarget.selectionStart);\r\n                                                    }\r\n                                                }}\r\n                                                onFocus={(e) => adjustHeight(e.target)}\r\n                                                spellCheck={false}\r\n                                                rows={Math.max(2, cell.content.split('\\n').length)}\r\n                                            />\r\n                                        </div>\r\n                                    </div>\r\n                                ) : (\r\n                                    <div\r\n                                        className={`transition-all duration-500 ${activeCellId === cell.id\r\n                                            ? 'bg-[#f5f5f7] dark:bg-[#1a1a1a] rounded-xl border border-gray-200 dark:border-[#333] shadow-sm animate-in fade-in slide-in-from-top-2 overflow-visible'\r\n                                            : 'bg-transparent border-transparent overflow-hidden'\r\n                                            }`}\r\n                                        onDoubleClick={() => setActiveCellId(cell.id)}\r\n                                        onMouseEnter={() => handleCellMouseEnter()}\r\n                                        onMouseLeave={() => handleCellMouseLeave(cell.id)}\r\n                                    >\r\n\r\n                                        {activeCellId === cell.id ? (\r\n                                            <div className=\"flex flex-col min-h-full animate-in slide-in-from-top-2 duration-300\">\r\n                                                {/* Simple Source Editor */}\r\n                                                <div className=\"p-4 border-b border-gray-100 dark:border-[#2f2f2f] relative transition-all\" data-cell-id={cell.id}>\r\n                                                    <textarea\r\n                                                        autoFocus\r\n                                                        className=\"w-full bg-transparent outline-none font-mono text-sm leading-relaxed text-gray-800 dark:text-gray-200 resize-none min-h-[100px]\"\r\n                                                        value={cell.content}\r\n                                                        onChange={(e) => {\r\n                                                            const val = e.target.value;\r\n                                                            // Slash command detection - look for / at start of line or after space\r\n                                                            const cursorPosition = e.target.selectionStart;\r\n                                                            const textBeforeCursor = val.substring(0, cursorPosition);\r\n                                                            if (textBeforeCursor.endsWith('/') && (textBeforeCursor.length === 1 || textBeforeCursor[textBeforeCursor.length - 2] === ' ' || textBeforeCursor[textBeforeCursor.length - 2] === '\\n')) {\r\n                                                                setActiveSlashMenuId(cell.id);\r\n                                                                setTextSearchQuery(''); // Reset search when triggering\r\n                                                            } else if (activeSlashMenuId === cell.id) {\r\n                                                                // Handle filtering\r\n                                                                const lastSlashIndex = textBeforeCursor.lastIndexOf('/');\r\n                                                                if (lastSlashIndex !== -1) {\r\n                                                                    setTextSearchQuery(textBeforeCursor.substring(lastSlashIndex + 1));\r\n                                                                } else {\r\n                                                                    setActiveSlashMenuId(null);\r\n                                                                }\r\n                                                            }\r\n                                                            setCells(prev => prev.map(c => c.id === cell.id ? { ...c, content: val } : c));\r\n                                                            adjustHeight(e.target);\r\n                                                        }}\r\n                                                        onKeyDown={(e) => {\r\n                                                            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {\r\n                                                                e.preventDefault();\r\n                                                                handleSplitCell(cell.id, e.currentTarget.selectionStart);\r\n                                                            }\r\n                                                        }}\r\n                                                        onFocus={(e) => adjustHeight(e.target)}\r\n                                                        rows={Math.max(4, cell.content.split('\\n').length)}\r\n                                                        placeholder=\"Type markdown... (try / for commands)\"\r\n                                                        spellCheck={false}\r\n                                                    />\r\n\r\n                                                    {/* Dedicated Slash Command Menu - Ultra Compact & Responsive */}\r\n                                                    {activeSlashMenuId === cell.id && (\r\n                                                        <div className=\"absolute left-12 top-6 w-48 bg-white/95 dark:bg-[#1a1a1a]/95 backdrop-blur-sm border border-gray-200 dark:border-[#333] rounded-lg shadow-xl z-[100] animate-in fade-in zoom-in-95 duration-200 slash-command-menu ring-1 ring-black/5 overflow-y-auto subtle-scrollbar min-w-[120px] max-h-48\">\r\n                                                            <div className=\"p-1\">\r\n                                                                {textBlockTypes.filter(b => b.label.toLowerCase().includes(textSearchQuery.toLowerCase())).map(block => (\r\n                                                                    <button\r\n                                                                        key={block.id}\r\n                                                                        onClick={(e) => {\r\n                                                                            e.stopPropagation();\r\n                                                                            setCells(prev => prev.map(c => {\r\n                                                                                if (c.id === cell.id) {\r\n                                                                                    const lastSlashIndex = c.content.lastIndexOf('/');\r\n                                                                                    return { ...c, content: c.content.substring(0, lastSlashIndex) + block.prefix };\r\n                                                                                }\r\n                                                                                return c;\r\n                                                                            }));\r\n                                                                            setActiveSlashMenuId(null);\r\n                                                                            setLastSelectedPrefix(block.prefix);\r\n                                                                        }}\r\n                                                                        className=\"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-gray-100 dark:hover:bg-[#2a2a2a] rounded-md group transition-colors text-left\"\r\n                                                                    >\r\n                                                                        <div className=\"w-5 h-5 flex-shrink-0 flex items-center justify-center bg-gray-50 dark:bg-[#222] border border-gray-200 dark:border-[#333] rounded text-gray-400 group-hover:text-gray-600 dark:group-hover:text-gray-200 transition-all font-bold text-[8px] uppercase tracking-tighter\">\r\n                                                                            {block.shortcut}\r\n                                                                        </div>\r\n                                                                        <div className=\"text-[12px] font-medium text-gray-700 dark:text-gray-300 font-sans truncate\">\r\n                                                                            {block.label}\r\n                                                                        </div>\r\n                                                                    </button>\r\n                                                                ))}\r\n                                                                {textBlockTypes.filter(b => b.label.toLowerCase().includes(textSearchQuery.toLowerCase())).length === 0 && (\r\n                                                                    <div className=\"p-2 text-center text-[10px] text-gray-400 italic\">No matches</div>\r\n                                                                )}\r\n                                                            </div>\r\n                                                        </div>\r\n                                                    )}\r\n                                                    {/* Pop-up Delete Button */}\r\n                                                    <button\r\n                                                        onClick={(e) => { e.stopPropagation(); handleDeleteCell(cell.id); }}\r\n                                                        className=\"absolute top-2 right-2 p-1.5 bg-white dark:bg-[#252525] text-gray-400 hover:text-red-500 border border-gray-200 dark:border-[#333] rounded-md shadow-sm transition-all active:scale-95 z-20\"\r\n                                                        title=\"Delete cell\"\r\n                                                    >\r\n                                                        <Trash2 size={12} />\r\n                                                    </button>\r\n                                                </div>\r\n\r\n                                                {/* Clean Preview (Vertical) */}\r\n                                                <div className=\"bg-white dark:bg-[#1e1e1e] p-6 lg:p-8\">\r\n                                                    <div className=\"prose prose-sm dark:prose-invert max-w-none \r\n                                                        prose-headings:font-bold prose-headings:tracking-tight\r\n                                                        prose-p:leading-relaxed prose-p:text-gray-600 dark:prose-p:text-gray-400\r\n                                                        prose-img:rounded-xl\r\n                                                    \">\r\n                                                        <ReactMarkdown remarkPlugins={[remarkGfm]}>\r\n                                                            {cell.content || '*Preview area...*'}\r\n                                                        </ReactMarkdown>\r\n                                                    </div>\r\n                                                </div>\r\n                                            </div>\r\n                                        ) : (\r\n                                            /* Static View Mode - No Border, No Header */\r\n                                            <div className=\"bg-transparent p-2 lg:p-4\">\r\n                                                <div className=\"prose prose-sm dark:prose-invert max-w-none \r\n                                                    prose-headings:font-bold prose-headings:tracking-tight\r\n                                                    prose-p:leading-relaxed prose-p:text-gray-600 dark:prose-p:text-gray-400\r\n                                                    prose-img:rounded-xl\r\n                                                \">\r\n                                                    <ReactMarkdown remarkPlugins={[remarkGfm]}>\r\n                                                        {cell.content || 'Double click to edit...'}\r\n                                                    </ReactMarkdown>\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                )}\r\n\r\n                                {/* Output Area */}\r\n                                {cell.type === 'code' && cell.output && (\r\n                                    <div className=\"mt-4 animate-in slide-in-from-top-2 fade-in duration-200\">\r\n                                        <div className=\"flex items-center gap-2 mb-2 px-1\">\r\n                                            <span className=\"text-[10px] font-mono text-gray-400 uppercase tracking-wider\">Out [{index + 1}]:</span>\r\n                                            {cell.status === 'success' && <Check size={10} className=\"text-green-500\" />}\r\n                                            {cell.status === 'error' && <AlertCircle size={10} className=\"text-red-500\" />}\r\n                                        </div>\r\n\r\n                                        {cell.output.type === 'error' && (\r\n                                            <div className=\"bg-red-50 dark:bg-red-900/10 p-4 rounded-xl border border-red-100 dark:border-red-900/30 overflow-x-auto text-red-600 dark:text-red-400 font-mono text-xs\">\r\n                                                <pre>{cell.output.data as string}</pre>\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {cell.output.type === 'text' && (\r\n                                            <div className=\"bg-white dark:bg-[#111] p-4 rounded-xl border border-gray-200 dark:border-[#333] overflow-x-auto text-gray-700 dark:text-gray-300 font-mono text-sm whitespace-pre-wrap\">\r\n                                                {cell.output.data as string}\r\n                                            </div>\r\n                                        )}\r\n\r\n                                        {cell.output.type === 'table' && (\r\n                                            <div className=\"bg-white dark:bg-[#111] rounded-xl border border-gray-200 dark:border-[#333] overflow-hidden shadow-sm\">\r\n                                                {cell.output.visualHint && (\r\n                                                    <div className=\"p-4 border-b border-gray-200 dark:border-[#333]\">\r\n                                                        <ChatChart\r\n                                                            data={cell.output.data as TableData}\r\n                                                            type={cell.output.visualHint}\r\n                                                        />\r\n                                                    </div>\r\n                                                )}\r\n                                                <div className=\"p-2\">\r\n                                                    <EmbeddedTable\r\n                                                        data={cell.output.data as TableData}\r\n                                                        fileName=\"Result\"\r\n                                                        visualHint={cell.output.visualHint}\r\n                                                        onExpand={() => { }}\r\n                                                    />\r\n                                                </div>\r\n                                            </div>\r\n                                        )}\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n\r\n                            {/* Add Cell Gutter (Bottom) - Deepnote Style Unified Toolbar */}\r\n                            <div className={`h-4 group/add flex items-center justify-center transition-all duration-300 ${activeTextDropdownId === cell.id ? 'opacity-100' : 'opacity-0 hover:opacity-100'}`}>\r\n                                <div className=\"h-px bg-blue-500/20 dark:bg-blue-500/10 w-full relative group-hover/add:bg-blue-500/40 transition-colors\">\r\n                                    <div className=\"absolute left-1/2 -translate-x-1/2 -translate-y-1/2 flex items-stretch bg-white dark:bg-[#1a1a1a] border border-gray-200 dark:border-[#333] rounded-lg shadow-sm hover:shadow-md transition-all z-40\">\r\n                                        <button\r\n                                            onClick={() => handleAddCell('code', cell.id)}\r\n                                            className=\"flex items-center gap-2 px-3 py-1.5 hover:bg-gray-50 dark:hover:bg-[#252525] text-gray-700 dark:text-gray-300 transition-colors border-r border-gray-100 dark:border-[#2a2a2a] rounded-l-lg\"\r\n                                        >\r\n                                            <Code2 size={15} className=\"text-gray-400\" />\r\n                                            <span className=\"text-[12px] font-medium font-sans\">Code</span>\r\n                                        </button>\r\n                                        <div className=\"relative\">\r\n                                            <button\r\n                                                onClick={(e) => { e.stopPropagation(); setActiveTextDropdownId(activeTextDropdownId === cell.id ? null : cell.id); }}\r\n                                                className={`flex items-center gap-2 px-3 py-1.5 hover:bg-gray-50 dark:hover:bg-[#252525] text-gray-700 dark:text-gray-300 transition-colors border-r border-gray-100 dark:border-[#2a2a2a] ${activeTextDropdownId === cell.id ? 'bg-gray-50 dark:bg-[#252525]' : ''}`}\r\n                                            >\r\n                                                <Type size={15} className=\"text-gray-400\" />\r\n                                                <span className=\"text-[12px] font-medium font-sans\">Text</span>\r\n                                                <ChevronDown size={12} className={`text-gray-400 transition-transform ${activeTextDropdownId === cell.id ? 'rotate-180' : ''}`} />\r\n                                            </button>\r\n\r\n                                            {activeTextDropdownId === cell.id && (\r\n                                                <div className=\"absolute top-full left-0 mt-2 w-48 bg-white/95 dark:bg-[#1a1a1a]/95 backdrop-blur-sm border border-gray-200 dark:border-[#333] rounded-lg shadow-xl z-[100] animate-in fade-in zoom-in-95 duration-200 text-block-dropdown ring-1 ring-black/5\">\r\n                                                    <div className=\"p-1.5 border-b border-gray-100 dark:border-[#2a2a2a]\">\r\n                                                        <div className=\"relative\">\r\n                                                            <Search size={12} className=\"absolute left-2 top-1/2 -translate-y-1/2 text-gray-400\" />\r\n                                                            <input\r\n                                                                autoFocus\r\n                                                                value={textSearchQuery}\r\n                                                                onChange={(e) => setTextSearchQuery(e.target.value)}\r\n                                                                placeholder=\"Search...\"\r\n                                                                className=\"w-full pl-7 pr-2 py-1 bg-gray-50/50 dark:bg-[#252525] border border-gray-100 dark:border-[#333] rounded text-[11px] outline-none focus:border-blue-500/50 transition-all font-sans\"\r\n                                                            />\r\n                                                        </div>\r\n                                                    </div>\r\n                                                    <div className=\"max-h-60 overflow-y-auto p-1 subtle-scrollbar\">\r\n                                                        {textBlockTypes.filter(b => b.label.toLowerCase().includes(textSearchQuery.toLowerCase())).map(block => (\r\n                                                            <button\r\n                                                                key={block.id}\r\n                                                                onClick={(e) => {\r\n                                                                    e.stopPropagation();\r\n                                                                    handleAddCell('markdown', cell.id, block.prefix);\r\n                                                                    setActiveTextDropdownId(null);\r\n                                                                    setTextSearchQuery('');\r\n                                                                    setLastSelectedPrefix(block.prefix);\r\n                                                                }}\r\n                                                                className=\"w-full flex items-center gap-2 px-2 py-1.5 hover:bg-gray-100 dark:hover:bg-[#2a2a2a] rounded-md group transition-colors text-left\"\r\n                                                            >\r\n                                                                <div className=\"w-5 h-5 flex-shrink-0 flex items-center justify-center bg-gray-50 dark:bg-[#222] border border-gray-200 dark:border-[#333] rounded text-gray-400 group-hover:text-gray-600 dark:group-hover:text-gray-200 transition-all font-bold text-[8px] uppercase tracking-tighter\">\r\n                                                                    {block.shortcut}\r\n                                                                </div>\r\n                                                                <div className=\"text-[12px] font-medium text-gray-700 dark:text-gray-300 font-sans truncate\">\r\n                                                                    {block.label}\r\n                                                                </div>\r\n                                                            </button>\r\n                                                        ))}\r\n                                                    </div>\r\n                                                </div>\r\n                                            )}\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-2 px-3 py-1.5 hover:bg-gray-50 dark:hover:bg-[#252525] text-gray-700 dark:text-gray-300 transition-colors border-r border-gray-100 dark:border-[#2a2a2a] cursor-not-allowed opacity-60\">\r\n                                            <Database size={15} className=\"text-gray-400\" />\r\n                                            <span className=\"text-[12px] font-medium font-sans\">SQL</span>\r\n                                            <ChevronDown size={12} className=\"text-gray-400\" />\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-2 px-3 py-1.5 hover:bg-gray-50 dark:hover:bg-[#252525] text-gray-700 dark:text-gray-300 transition-colors border-r border-gray-100 dark:border-[#2a2a2a] cursor-not-allowed opacity-60\">\r\n                                            <BarChart3 size={15} className=\"text-gray-400\" />\r\n                                            <span className=\"text-[12px] font-medium font-sans\">Chart</span>\r\n                                            <ChevronDown size={12} className=\"text-gray-400\" />\r\n                                        </div>\r\n                                        <div className=\"flex items-center gap-2 px-3 py-1.5 hover:bg-gray-50 dark:hover:bg-[#252525] text-gray-700 dark:text-gray-300 transition-colors cursor-not-allowed opacity-60 rounded-r-lg\">\r\n                                            <PenLine size={15} className=\"text-gray-400\" />\r\n                                            <span className=\"text-[12px] font-medium font-sans\">Input</span>\r\n                                            <ChevronDown size={12} className=\"text-gray-400\" />\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    ))}\r\n\r\n                    {/* Empty State / Bottom Add */}\r\n                    {cells.length === 0 && (\r\n                        <div className=\"flex flex-col items-center justify-center py-20 text-gray-400 border-2 border-dashed border-gray-100 dark:border-[#333] rounded-3xl\">\r\n                            <div className=\"mb-4 p-4 bg-gray-50 dark:bg-[#252525] rounded-full\">\r\n                                <Terminal size={24} className=\"opacity-50\" />\r\n                            </div>\r\n                            <p className=\"mb-6 font-medium\">Notebook is empty</p>\r\n                            <div className=\"flex gap-4\">\r\n                                <button\r\n                                    onClick={() => handleAddCell('code')}\r\n                                    className=\"flex items-center gap-3 px-8 py-4 bg-blue-600 dark:bg-blue-500 text-white rounded-2xl font-bold text-sm uppercase tracking-wider hover:bg-blue-700 dark:hover:bg-blue-600 transition-all shadow-xl hover:shadow-blue-500/20 transform hover:-translate-y-1 active:scale-95\"\r\n                                >\r\n                                    <Plus size={20} className=\"stroke-[3]\" /> Add Code Block\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => handleAddCell('markdown')}\r\n                                    className=\"flex items-center gap-3 px-8 py-4 bg-white dark:bg-[#333] text-gray-700 dark:text-white border border-gray-200 dark:border-[#444] rounded-2xl font-bold text-sm uppercase tracking-wider hover:bg-gray-50 transition-all shadow-lg hover:shadow-gray-200 dark:hover:shadow-none transform hover:-translate-y-1 active:scale-95\"\r\n                                >\r\n                                    <FileText size={20} /> Add Text\r\n                                </button>\r\n                            </div>\r\n                        </div>\r\n                    )}\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n"],"names":[],"mappings":"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","debugId":null}}]
}